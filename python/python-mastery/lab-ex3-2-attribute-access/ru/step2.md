# Использование `getattr()` для универсальной обработки объектов

Функция `getattr()` представляет собой мощный инструмент в Python, который позволяет динамически получать доступ к атрибутам объекта. Это особенно полезно, когда вы хотите обрабатывать объекты универсальным способом. Вместо написания кода, специфичного для определенного типа объекта, вы можете использовать `getattr()` для работы с любым объектом, имеющим необходимые атрибуты. Эта гибкость делает ваш код более переиспользуемым и адаптивным.

## Обработка нескольких атрибутов

Начнем с изучения того, как получить доступ к нескольким атрибутам объекта с помощью функции `getattr()`. Это распространенный сценарий, когда вам нужно извлечь определенную информацию из объекта.

Сначала откройте интерактивную оболочку Python, если вы закрыли предыдущую. Вы можете сделать это, запустив следующую команду в терминале:

```python
# Open a Python interactive shell if you closed the previous one
python3
```

Затем импортируем класс `Stock` и создадим объект `Stock`. Класс `Stock` представляет акцию с атрибутами, такими как `name`, `shares` и `price`.

```python
# Import the Stock class and create a stock object
from stock import Stock
s = Stock('GOOG', 100, 490.1)
```

Теперь определим список имен атрибутов, к которым мы хотим получить доступ. Этот список поможет нам пройти по атрибутам и вывести их значения.

```python
# Define a list of attribute names
fields = ['name', 'shares', 'price']
```

Наконец, используем цикл `for` для перебора списка имен атрибутов и получения доступа к каждому атрибуту с помощью `getattr()`. На каждой итерации мы выведем имя атрибута и его значение.

```python
# Access each attribute using getattr()
for name in fields:
    print(f"{name}: {getattr(s, 'name')}" if name == 'name' else f"{name}: {getattr(s, name)}")
```

При запуске этого кода вы увидите следующий вывод:

```
name: GOOG
shares: 100
price: 490.1
```

Этот вывод показывает, что мы смогли получить доступ и вывести значения нескольких атрибутов объекта `Stock` с помощью функции `getattr()`.

## Значения по умолчанию с `getattr()`

Функция `getattr()` также предоставляет полезную возможность: возможность указать значение по умолчанию, если атрибут, к которому вы пытаетесь получить доступ, не существует. Это может помочь избежать возникновения ошибки `AttributeError` в вашем коде и сделать его более надежным.

Посмотрим, как это работает. Сначала попробуем получить доступ к атрибуту, который не существует в объекте `Stock`. Мы используем `getattr()` и указываем значение по умолчанию `'N/A'`.

```python
# Try to access an attribute that doesn't exist
print(getattr(s, 'symbol', 'N/A'))  # Output: 'N/A'
```

В этом случае, так как атрибут `symbol` не существует в объекте `Stock`, функция `getattr()` возвращает значение по умолчанию `'N/A'`.

Теперь сравним это с получением доступа к существующему атрибуту. Мы получим доступ к атрибуту `name`, который существует в объекте `Stock`.

```python
# Compare with an existing attribute
print(getattr(s, 'name', 'N/A'))    # Output: 'GOOG'
```

Здесь функция `getattr()` возвращает фактическое значение атрибута `name`, которое равно `'GOOG'`.

## Обработка коллекции объектов

Функция `getattr()` становится еще более мощной, когда вам нужно обработать коллекцию объектов. Посмотрим, как можно использовать ее для обработки портфеля акций.

Сначала импортируем функцию `read_portfolio` из модуля `stock`. Эта функция считывает портфель акций из CSV-файла и возвращает список объектов `Stock`.

```python
# Import the portfolio reading function
from stock import read_portfolio
```

Затем используем функцию `read_portfolio` для чтения портфеля из CSV-файла с именем `portfolio.csv`.

```python
# Read the portfolio from CSV file
portfolio = read_portfolio('portfolio.csv')
```

Наконец, используем цикл `for` для перебора списка объектов `Stock` в портфеле. Для каждой акции используем `getattr()` для доступа к атрибутам `name` и `shares` и вывода их значений.

```python
# Print the name and shares of each stock
for stock in portfolio:
    print(f"Stock: {getattr(stock, 'name')}, Shares: {getattr(stock, 'shares')}")
```

Такой подход делает ваш код более гибким, так как вы можете работать с именами атрибутов как со строками. Эти строки могут передаваться в качестве аргументов или храниться в структурах данных, что позволяет легко изменять атрибуты, к которым вы хотите получить доступ, без изменения основной логики вашего кода.
