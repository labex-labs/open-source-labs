# Особый проект по вызову вызовов

В упражнении 2.5 мы создали класс `RideData`, который хранил все данные автобуса в столбцах, но фактически представлял данные пользователю в виде последовательности словарей. Это позволило экономить много памяти за счет различных форм магии.

Вы можете обобщить эту идею? Specifically, можете ли вы создать универсальную функцию `read_csv_as_columns()`, которая работает так:

```python
>>> data = read_csv_as_columns('ctabus.csv', types=[str, str, str, int])
>>> data
<__main__.DataCollection object at 0x102b45048>
>>> len(data)
577563
>>> data[0]
{'route': '3', 'date': '01/01/2001', 'daytype': 'U', 'rides': 7354}
>>> data[1]
{'route': '4', 'date': '01/01/2001', 'daytype': 'U', 'rides': 9288}
>>> data[2]
{'route': '6', 'date': '01/01/2001', 'daytype': 'U', 'rides': 6048}
>>>
```

Эта функция должна быть универсальной - вы можете передать ей любой файл и список типов столбцов, и она прочитает данные. Данные считываются в класс `DataCollection`, который хранит данные в виде столбцов внутри. Однако, данные представляют себя в виде последовательности словарей при доступе.

Попробуйте использовать эту функцию с трюком по интернированию строк в последней части. Сколько памяти занимает хранение всех данных о поездках теперь? Может ли вы по-прежнему использовать эту функцию с вашим ранним кодом анализа CTA?

## Примечание:

Завершите функцию `read_csv_as_columns()` в файле `colreader.py`.
