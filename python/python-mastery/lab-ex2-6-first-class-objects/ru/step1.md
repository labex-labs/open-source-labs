# Понимание объектов первого класса в Python

В Python все рассматривается как объект. Это включает в себя функции и типы. Что это значит? Это означает, что вы можете хранить функции и типы в структурах данных, передавать их в качестве аргументов другим функциям и даже возвращать их из других функций. Это очень мощная концепция, и мы рассмотрим ее на примере обработки данных в формате CSV.

## Исследование типов первого класса

Сначала запустим интерпретатор Python. Откройте новый терминал в WebIDE и введите следующую команду. Эта команда запустит интерпретатор Python, где мы будем запускать наш код на Python.

```bash
python3
```

При работе с файлами CSV в Python нам часто нужно преобразовать строки, которые мы читаем из этих файлов, в соответствующие типы данных. Например, число в файле CSV может быть прочитано как строка, но мы хотим использовать его как целое число или число с плавающей точкой в нашем коде на Python. Для этого мы можем создать список функций преобразования.

```python
coltypes = [str, int, float]
```

Обратите внимание, что мы создаем список, содержащий фактические функции типов, а не строки. В Python типы являются объектами первого класса, что означает, что мы можем обращаться с ними так же, как с любым другим объектом. Мы можем помещать их в списки, передавать их и использовать в нашем коде.

Теперь прочитаем некоторые данные из файла CSV с портфелем, чтобы увидеть, как мы можем использовать эти функции преобразования.

```python
import csv
f = open('portfolio.csv')
rows = csv.reader(f)
headers = next(rows)
row = next(rows)
print(row)
```

При запуске этого кода вы должны увидеть вывод, похожий на следующий. Это первая строка данных из файла CSV, представленная в виде списка строк.

```
['AA', '100', '32.20']
```

Далее мы будем использовать функцию `zip`. Функция `zip` принимает несколько итерируемых объектов (например, списки или кортежи) и объединяет их элементы в пары. Мы будем использовать ее, чтобы соотнести каждое значение из строки с соответствующей функцией преобразования типа.

```python
r = list(zip(coltypes, row))
print(r)
```

В результате получится следующий вывод. Каждая пара содержит функцию типа и строковое значение из файла CSV.

```
[(<class 'str'>, 'AA'), (<class 'int'>, '100'), (<class 'float'>, '32.20')]
```

Теперь, когда у нас есть эти пары, мы можем применить каждую функцию, чтобы преобразовать значения в соответствующие типы.

```python
record = [func(val) for func, val in zip(coltypes, row)]
print(record)
```

В выводе будет показано, что значения были преобразованы в соответствующие типы. Строка 'AA' остается строкой, '100' становится целым числом 100, а '32.20' становится числом с плавающей точкой 32.2.

```
['AA', 100, 32.2]
```

Мы также можем объединить эти значения с именами столбцов, чтобы создать словарь. Словарь - это полезная структура данных в Python, которая позволяет хранить пары ключ - значение.

```python
record_dict = dict(zip(headers, record))
print(record_dict)
```

В выводе будет словарь, где ключами являются имена столбцов, а значениями - преобразованные данные.

```
{'name': 'AA', 'shares': 100, 'price': 32.2}
```

Вы можете выполнить все эти шаги в одном выражении - генераторе. Генератор - это компактный способ создания списков, словарей или множеств в Python.

```python
result = {name: func(val) for name, func, val in zip(headers, coltypes, row)}
print(result)
```

В выводе будет тот же словарь, что и раньше.

```
{'name': 'AA', 'shares': 100, 'price': 32.2}
```

Когда вы закончите работу в интерпретаторе Python, вы можете выйти из него, введя следующую команду.

```python
exit()
```

Это демонстрация показывает, как отношение Python к функциям как к объектам первого класса позволяет использовать мощные методы обработки данных. Благодаря тому, что мы можем рассматривать типы и функции как объекты, мы можем писать более гибкий и компактный код.
