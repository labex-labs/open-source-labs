# Данные первого класса

В файле `portfolio.csv` вы читали данные, организованные в столбцы, которые выглядят так:

```python
"AA",100,32.20
"IBM",50,91.10
...
```

В предыдущем коде эти данные обрабатывались путём жесткого кодирования всех преобразований типов. Например:

```python
rows = csv.reader(f)
for row in rows:
    name   = row[0]
    shares = int(row[1])
    price  = float(row[2])
```

Такое преобразование также можно выполнить более умело, используя некоторые операции со списками. Создайте Python-список, содержащий преобразования, которые вы хотите выполнить для каждого столбца:

```python
>>> coltypes = [str, int, float]
>>>
```

Причина, по которой вы даже можете создать этот список, заключается в том, что всё в Python является "данными первого класса". Поэтому, если вы хотите иметь список функций, это нормально.

Теперь прочитайте строку данных из вышеуказанного файла:

```python
>>> import csv
>>> f = open('portfolio.csv')
>>> rows = csv.reader(f)
>>> headers = next(rows)
>>> row = next(rows)
>>> row
['AA', '100', '32.20']
>>>
```

Объедините типы столбцов с строкой и посмотрите на результат:

```python
>>> r = list(zip(coltypes, row))
>>> r
[(<class'str'>, 'AA'), (<class 'int'>, '100'), (<class 'float'>,'32.20')]
>>>
```

Вы заметите, что это сопоставило преобразование типа со значением. Например, `int` сопоставлено со значением `'100'`. Теперь попробуйте это:

```python
>>> record = [func(val) for func, val in zip(coltypes, row)]
>>> record
['AA', 100, 32.2]
>>>
```

Убедитесь, что понимаете, что происходит в вышеприведённом коде. В цикле переменная `func` является одной из функций преобразования типов (например, `str`, `int` и т.д.), а переменная `val` является одним из значений, таких как `'AA'`, `'100'`. Выражение `func(val)` преобразует значение (有点像类型转换).

Вы можете пойти дальше и создать словари, используя заголовки столбцов. Например:

```python
>>> dict(zip(headers, record))
{'name': 'AA','shares': 100, 'price': 32.2}
>>>
```

Если вам нравится, вы можете выполнить все эти шаги сразу, используя comprehensions для словарей:

```python
>>> { name:func(val) for name, func, val in zip(headers, coltypes, row) }
{'name': 'AA','shares': 100, 'price': 32.2}
>>>
```
