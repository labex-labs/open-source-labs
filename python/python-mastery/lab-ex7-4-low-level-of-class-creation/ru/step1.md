# Ручное создание класса

В программировании на Python классы являются фундаментальным понятием, которое позволяет группировать данные и функции вместе. Обычно мы определяем классы с использованием стандартного синтаксиса Python. Например, вот простой класс `Stock`. Этот класс представляет акцию с атрибутами, такими как `name`, `shares` и `price`, и имеет методы для расчета стоимости и продажи акций.

```python
class Stock:
    def __init__(self, name, shares, price):
        self.name = name
        self.shares = shares
        self.price = price

    def cost(self):
        return self.shares * self.price

    def sell(self, nshares):
        self.shares -= nshares
```

Но вы когда-нибудь задумывались, как Python на самом деле создает класс "за кулисами"? Что, если мы хотим создать этот класс, не используя стандартный синтаксис классов? В этом разделе мы рассмотрим, как классы Python создаются на более низком уровне.

## Запуск интерактивной оболочки Python

Для начала экспериментов с ручным созданием классов нам нужно открыть интерактивную оболочку Python. Эта оболочка позволяет нам выполнять код Python построчно, что очень удобно для обучения и тестирования.

Откройте терминал в WebIDE и запустите интерактивную оболочку Python, введя следующие команды. Первая команда `cd ~/project` изменяет текущую директорию на директорию проекта, а вторая команда `python3` запускает интерактивную оболочку Python 3.

```bash
cd ~/project
python3
```

## Определение методов как обычных функций

Перед тем, как мы создадим класс вручную, нам нужно определить методы, которые будут частью этого класса. В Python методы - это просто функции, связанные с классом. Поэтому давайте определим методы, которые мы хотим иметь в нашем классе, как обычные функции Python.

```python
def __init__(self, name, shares, price):
    self.name = name
    self.shares = shares
    self.price = price

def cost(self):
    return self.shares * self.price

def sell(self, nshares):
    self.shares -= nshares
```

Здесь функция `__init__` является специальным методом в классах Python. Она называется конструктором и используется для инициализации атрибутов объекта при создании экземпляра класса. Метод `cost` вычисляет общую стоимость акций, а метод `sell` уменьшает количество акций.

## Создание словаря методов

Теперь, когда мы определили наши методы как обычные функции, нам нужно организовать их таким образом, чтобы Python мог понять их при создании класса. Мы делаем это, создав словарь, который будет содержать все методы нашего класса.

```python
methods = {
    '__init__': __init__,
    'cost': cost,
    'sell': sell
}
```

В этом словаре ключи - это имена методов, которые будут использоваться в классе, а значения - это сами объекты функций, которые мы определили ранее.

## Использование конструктора type() для создания класса

В Python функция `type()` является встроенной функцией, которая может быть использована для создания классов на более низком уровне. Функция `type()` принимает три аргумента:

1. Имя класса: Это строка, которая представляет имя класса, который мы хотим создать.
2. Кортеж базовых классов: В Python классы могут наследоваться от других классов. Здесь мы используем `(object,)`, что означает, что наш класс наследуется от базового класса `object`, который является базовым классом для всех классов в Python.
3. Словарь, содержащий методы и атрибуты: Это словарь, который мы создали ранее и который содержит все методы нашего класса.

```python
Stock = type('Stock', (object,), methods)
```

Эта строка кода создает новый класс с именем `Stock` с использованием функции `type()`. Класс наследуется от класса `object` и имеет методы, определенные в словаре `methods`.

## Тестирование нашего вручную созданного класса

Теперь, когда мы создали наш класс вручную, давайте протестируем его, чтобы убедиться, что он работает как ожидается. Мы создадим экземпляр нашего нового класса и вызовем его методы.

```python
s = Stock('GOOG', 100, 490.10)
print(s.name)
print(s.cost())
s.sell(25)
print(s.shares)
```

В первой строке мы создаем экземпляр класса `Stock` с именем `GOOG`, 100 акциями и ценой 490.10. Затем мы выводим имя акции, вычисляем и выводим стоимость, продаем 25 акций и, наконец, выводим оставшееся количество акций.

Вы должны увидеть следующий вывод:

```
GOOG
49010.0
75
```

Этот вывод показывает, что наш вручную созданный класс работает так же, как класс, созданный с использованием стандартного синтаксиса Python. Это демонстрирует, что класс по сути представляет собой просто имя, кортеж базовых классов и словарь методов и атрибутов. Функция `type()` просто создает объект класса из этих компонентов.

Выйдите из оболочки Python, когда закончите:

```python
exit()
```
