# Управление экспортируемыми символами с помощью `__all__`

В Python, когда вы используете инструкцию `from module import *`, вы, возможно, захотите контролировать, какие символы (функции, классы, переменные) импортируются из модуля. Именно здесь пригодится переменная `__all__`. Инструкция `from module import *` представляет собой способ импорта всех символов из модуля в текущее пространство имен. Однако иногда вы не хотите импортировать каждый отдельный символ, особенно если их много или если некоторые из них предназначены только для внутреннего использования в модуле. Переменная `__all__` позволяет вам точно указать, какие символы должны быть импортированы при использовании этой инструкции.

## Что такое `__all__`?

Переменная `__all__` представляет собой список строк. Каждая строка в этом списке представляет символ (функцию, класс или переменную), который экспортирует модуль, когда кто - то использует инструкцию `from module import *`. Если переменная `__all__` не определена в модуле, инструкция `import *` импортирует все символы, которые не начинаются с подчеркивания. Символы, начинающиеся с подчеркивания, обычно считаются приватными или внутренними для модуля и не предназначены для прямого импорта.

## Изменение каждого подмодуля

Теперь давайте добавим переменную `__all__` в каждый подмодуль пакета `structly`. Это поможет нам контролировать, какие символы экспортируются из каждого подмодуля, когда кто - то использует инструкцию `from module import *`.

1. Сначала изменим файл `structure.py`:

```bash
touch ~/project/structly/structure.py
```

Эта команда создает новый файл с именем `structure.py` в директории `structly` вашего проекта. После создания файла нам нужно добавить переменную `__all__`. Добавьте следующую строку в верхней части файла, сразу после инструкций импорта:

```python
__all__ = ['Structure']
```

Эта строка сообщает Python, что когда кто - то использует `from structure import *`, будет импортирован только символ `Structure`. Сохраните файл и выйдите из редактора.

2. Далее изменим файл `reader.py`:

```bash
touch ~/project/structly/reader.py
```

Эта команда создает новый файл с именем `reader.py` в директории `structly`. Теперь просмотрите файл, чтобы найти все функции, которые начинаются с `read_csv_as_`. Эти функции - те, которые мы хотим экспортировать. Затем добавьте список `__all__` со всеми именами этих функций. Он должен выглядеть примерно так:

```python
__all__ = ['read_csv_as_instances', 'read_csv_as_dicts', 'read_csv_as_columns']
```

Обратите внимание, что фактические имена функций могут отличаться в зависимости от того, что вы найдете в файле. Убедитесь, что вы добавили все функции `read_csv_as_*`, которые нашли. Сохраните файл и выйдите из редактора.

3. Теперь изменим файл `tableformat.py`:

```bash
touch ~/project/structly/tableformat.py
```

Эта команда создает новый файл с именем `tableformat.py` в директории `structly`. Добавьте следующую строку в верхней части файла:

```python
__all__ = ['create_formatter', 'print_table']
```

Эта строка указывает, что когда кто - то использует `from tableformat import *`, будут импортированы только символы `create_formatter` и `print_table`. Сохраните файл и выйдите из редактора.

## Единый импорт в `__init__.py`

Теперь, когда каждый модуль определяет, что он экспортирует, мы можем обновить файл `__init__.py`, чтобы импортировать все эти символы. Файл `__init__.py` - это специальный файл в пакетах Python. Он выполняется при импорте пакета и может использоваться для инициализации пакета и импорта символов из подмодулей.

```bash
touch ~/project/structly/__init__.py
```

Эта команда создает новый файл `__init__.py` в директории `structly`. Измените содержимое файла на следующее:

```python
# structly/__init__.py

from .structure import *
from .reader import *
from .tableformat import *
```

Эти строки импортируют все экспортируемые символы из подмодулей `structure`, `reader` и `tableformat`. Точка (`.`) перед именами модулей указывает, что это относительные импорты, то есть импорты из того же пакета. Сохраните файл и выйдите из редактора.

## Тестирование наших изменений

Давайте создадим простой тестовый файл, чтобы проверить, что наши изменения работают. Этот тестовый файл попытается импортировать символы, указанные в переменных `__all__`, и вывести сообщение об успехе, если импорт прошел успешно.

```bash
touch ~/project/test_structly.py
```

Эта команда создает новый файл с именем `test_structly.py` в директории проекта. Добавьте следующее содержимое в файл:

```python
# A simple test to verify our imports work correctly

from structly import Structure
from structly import read_csv_as_instances
from structly import create_formatter, print_table

print("Successfully imported all required symbols!")
```

Эти строки пытаются импортировать класс `Structure`, функцию `read_csv_as_instances` и функции `create_formatter` и `print_table` из пакета `structly`. Если импорт прошел успешно, программа выведет сообщение "Successfully imported all required symbols!". Сохраните файл и выйдите из редактора. Теперь давайте запустим этот тест:

```bash
cd ~/project
python test_structly.py
```

Команда `cd ~/project` изменяет текущую рабочую директорию на директорию проекта. Команда `python test_structly.py` запускает скрипт `test_structly.py`. Если все работает правильно, вы должны увидеть на экране сообщение "Successfully imported all required symbols!".
