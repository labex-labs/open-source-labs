# Понимание генераторов Python

Генераторы - это мощная особенность Python. Они предоставляют простой и элегантный способ создания итераторов. В Python, когда вы работаете с последовательностями данных, итераторы очень полезны, так как они позволяют вам перебирать последовательность значений по одному. Обычные функции обычно возвращают одно значение и затем прекращают выполнение. Однако генераторы отличаются. Они могут выдавать последовательность значений со временем, что означает, что они могут порождать несколько значений поэтапно.

## Что такое генератор?

Функция - генератор имеет сходный внешний вид с обычной функцией. Но ключевое различие заключается в том, как она возвращает значения. Вместо использования оператора `return` для предоставления одного результата функция - генератор использует оператор `yield`. Оператор `yield` особенный. Каждый раз, когда он выполняется, состояние функции приостанавливается, и значение, следующее за ключевым словом `yield`, возвращается вызывающему коду. Когда функция - генератор вызывается снова, она продолжает выполнение с того места, где остановилась.

Давайте начнем с создания простой функции - генератора. Встроенная функция `range()` в Python не поддерживает дробные шаги. Поэтому мы создадим функцию - генератор, которая может создавать диапазон чисел с дробным шагом.

1. Сначала вам нужно открыть новый терминал Python в WebIDE. Для этого нажмите на меню "Terminal" и выберите "New Terminal".
2. После открытия терминала введите следующий код в терминале. Этот код определяет функцию - генератор и затем тестирует ее.

```python
def frange(start, stop, step):
    current = start
    while current < stop:
        yield current
        current += step

# Test the generator with a for loop
for x in frange(0, 2, 0.25):
    print(x, end=' ')
```

В этом коде функция `frange` является функцией - генератором. Она инициализирует переменную `current` значением `start`. Затем, пока `current` меньше значения `stop`, она выдает значение `current` и затем увеличивает `current` на значение `step`. Затем цикл `for` перебирает значения, порождаемые функцией - генератором `frange`, и выводит их.

Вы должны увидеть следующий вывод:

```
0 0.25 0.5 0.75 1.0 1.25 1.5 1.75
```

## Одноразовый характер генераторов

Важной характеристикой генераторов является то, что они исчерпаемы. Это означает, что после того, как вы перебрали все значения, порожденные генератором, его нельзя использовать снова для создания той же последовательности значений. Давайте продемонстрируем это на следующем коде:

```python
# Create a generator object
f = frange(0, 2, 0.25)

# First iteration works fine
print("First iteration:")
for x in f:
    print(x, end=' ')
print("\n")

# Second iteration produces nothing
print("Second iteration:")
for x in f:
    print(x, end=' ')
print("\n")
```

В этом коде мы сначала создаем объект - генератор `f` с помощью функции `frange`. Первый цикл `for` перебирает все значения, порожденные генератором, и выводит их. После первой итерации генератор исчерпан, то есть он уже порождает все значения, которые может. Поэтому, когда мы пытаемся перебрать его снова во втором цикле `for`, он не порождает новых значений.

Вывод:

```
First iteration:
0 0.25 0.5 0.75 1.0 1.25 1.5 1.75

Second iteration:

```

Обратите внимание, что вторая итерация не дала никакого вывода, потому что генератор уже был исчерпан.

## Создание переиспользуемых генераторов с помощью классов

Если вам нужно несколько раз перебирать одну и ту же последовательность значений, вы можете обернуть генератор в класс. Таким образом, каждый раз, когда вы начинаете новую итерацию, будет создан новый генератор.

```python
class FRange:
    def __init__(self, start, stop, step):
        self.start = start
        self.stop = stop
        self.step = step

    def __iter__(self):
        n = self.start
        while n < self.stop:
            yield n
            n += self.step

# Create an instance
f = FRange(0, 2, 0.25)

# We can iterate multiple times
print("First iteration:")
for x in f:
    print(x, end=' ')
print("\n")

print("Second iteration:")
for x in f:
    print(x, end=' ')
print("\n")
```

В этом коде мы определяем класс `FRange`. Метод `__init__` инициализирует значения `start`, `stop` и `step`. Метод `__iter__` - это специальный метод в классах Python. Он используется для создания итератора. Внутри метода `__iter__` у нас есть генератор, который порождает значения аналогично функции `frange`, которую мы определили ранее.

Когда мы создаем экземпляр `f` класса `FRange` и перебираем его несколько раз, каждая итерация вызывает метод `__iter__`, который создает новый генератор. Таким образом, мы можем получить одну и ту же последовательность значений несколько раз.

Вывод:

```
First iteration:
0 0.25 0.5 0.75 1.0 1.25 1.5 1.75

Second iteration:
0 0.25 0.5 0.75 1.0 1.25 1.5 1.75
```

На этот раз мы можем перебирать несколько раз, потому что метод `__iter__()` создает новый генератор каждый раз, когда он вызывается.
