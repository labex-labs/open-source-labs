# Ticker 클래스 생성

데이터 처리에서 원시 데이터를 사용하는 것은 매우 어려울 수 있습니다. 주식 데이터를 보다 체계적이고 효율적으로 처리하기 위해 주식 시세를 나타내는 적절한 클래스를 정의할 것입니다. 이 클래스는 주식 데이터의 청사진 역할을 하여 데이터 처리 파이프라인을 더욱 강력하고 관리하기 쉽게 만듭니다.

## ticker.py 파일 생성

1. 먼저 WebIDE 에서 새 파일을 만들어야 합니다. "New File" 아이콘을 클릭하거나 파일 탐색기에서 마우스 오른쪽 버튼을 클릭하고 "New File"을 선택하여 이 작업을 수행할 수 있습니다. 이 파일의 이름을 `ticker.py`로 지정합니다. 이 파일은 `Ticker` 클래스에 대한 코드를 저장합니다.

2. 이제 새로 생성된 `ticker.py` 파일에 다음 코드를 추가해 보겠습니다. 이 코드는 `Ticker` 클래스를 정의하고 이를 테스트하기 위한 간단한 처리 파이프라인을 설정합니다.

```python
# ticker.py

from structure import Structure, String, Float, Integer

class Ticker(Structure):
    name = String()
    price = Float()
    date = String()
    time = String()
    change = Float()
    open = Float()
    high = Float()
    low = Float()
    volume = Integer()

if __name__ == '__main__':
    from follow import follow
    import csv
    lines = follow('stocklog.csv')
    rows = csv.reader(lines)
    records = (Ticker.from_row(row) for row in rows)
    for record in records:
        print(record)
```

3. 코드를 추가한 후 파일을 저장합니다. `Ctrl+S`를 누르거나 메뉴에서 "File" → "Save"를 선택하여 이 작업을 수행할 수 있습니다. 파일을 저장하면 변경 사항이 유지되고 나중에 실행할 수 있습니다.

## 코드 이해

이 코드가 단계별로 수행하는 작업을 자세히 살펴보겠습니다.

1. 코드 시작 부분에서 `structure.py` 모듈에서 `Structure` 및 필드 유형을 가져옵니다. 이 모듈은 이미 설정되어 있습니다. 이러한 가져오기는 `Ticker` 클래스의 구성 요소를 제공하므로 필수적입니다. `Structure` 클래스는 `Ticker` 클래스의 기본 클래스가 되고, `String`, `Float`, `Integer`와 같은 필드 유형은 주식 데이터 필드의 데이터 유형을 정의합니다.

2. 다음으로, `Structure`에서 상속되는 `Ticker` 클래스를 정의합니다. 이 클래스에는 주식 데이터의 다양한 측면을 나타내는 여러 필드가 있습니다.

   - `name`: 이 필드는 "IBM" 또는 "AAPL"과 같은 주식 기호를 저장합니다. 이를 통해 어떤 회사의 주식인지 식별할 수 있습니다.
   - `price`: 주식의 현재 가격을 저장합니다. 이는 투자자에게 중요한 정보입니다.
   - `date` 및 `time`: 이 필드는 주식 시세가 생성된 시점을 알려줍니다. 시간과 날짜를 아는 것은 시간이 지남에 따른 주가 추세를 분석하는 데 중요합니다.
   - `change`: 이는 주식의 가격 변동을 나타냅니다. 이전 시점과 비교하여 주가가 상승했는지 하락했는지 보여줍니다.
   - `open`, `high`, `low`: 이 필드는 특정 기간 동안 주식의 시초가, 최고가 및 최저가를 나타냅니다. 이를 통해 주식의 가격 범위를 알 수 있습니다.
   - `volume`: 이 필드는 거래된 주식 수를 저장합니다. 높은 거래량은 특정 주식에 대한 시장의 강한 관심을 나타낼 수 있습니다.

3. `if __name__ == '__main__':` 블록에서 처리 파이프라인을 설정합니다. 이 코드 블록은 `ticker.py` 파일을 직접 실행할 때 실행됩니다.
   - `follow('stocklog.csv')`는 `stocklog.csv` 파일에서 줄을 생성하는 함수입니다. 이를 통해 파일을 한 줄씩 읽을 수 있습니다.
   - `csv.reader(lines)`는 이러한 줄을 가져와 행 데이터로 구문 분석합니다. CSV(쉼표로 구분된 값) 는 표 형식 데이터를 저장하는 일반적인 파일 형식이며, 이 함수는 각 행에서 데이터를 추출하는 데 도움이 됩니다.
   - `(Ticker.from_row(row) for row in rows)`는 제너레이터 표현식입니다. 각 데이터 행을 가져와 `Ticker` 객체로 변환합니다. 이러한 방식으로 원시 CSV 데이터를 작업하기 쉬운 구조화된 객체로 변환합니다.
   - `for` 루프는 이러한 `Ticker` 객체를 반복하고 각 객체를 인쇄합니다. 이를 통해 구조화된 데이터를 실제로 확인할 수 있습니다.

## 코드 실행

코드를 실행하여 작동 방식을 살펴보겠습니다.

1. 먼저 터미널에서 프로젝트 디렉토리에 있는지 확인해야 합니다. 아직 해당 디렉토리에 있지 않은 경우 다음 명령을 사용하여 이동합니다.

   ```bash
   cd /home/labex/project
   ```

2. 올바른 디렉토리에 있으면 다음 명령을 사용하여 `ticker.py` 스크립트를 실행합니다.

   ```bash
   python3 ticker.py
   ```

3. 스크립트를 실행한 후 다음과 유사한 출력을 볼 수 있습니다 (데이터는 다를 수 있음).
   ```
   Ticker(IBM, 103.53, 6/11/2007, 09:53.59, 0.46, 102.87, 103.53, 102.77, 541633)
   Ticker(MSFT, 30.21, 6/11/2007, 09:54.01, 0.16, 30.05, 30.21, 29.95, 7562516)
   Ticker(AA, 40.01, 6/11/2007, 09:54.01, 0.35, 39.67, 40.15, 39.31, 576619)
   Ticker(T, 40.1, 6/11/2007, 09:54.08, -0.16, 40.2, 40.19, 39.87, 1312959)
   ```

출력이 충분히 표시되면 `Ctrl+C`를 눌러 스크립트 실행을 중지할 수 있습니다.

원시 CSV 데이터가 구조화된 `Ticker` 객체로 변환된 방식을 확인하십시오. 이 변환을 통해 `Ticker` 클래스에 정의된 필드를 사용하여 주식 데이터에 액세스하고 조작할 수 있으므로 처리 파이프라인에서 데이터를 훨씬 쉽게 사용할 수 있습니다.
