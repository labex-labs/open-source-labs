# CSV 데이터를 사용한 기본 제너레이터 파이프라인

이 단계에서는 제너레이터를 사용하여 기본 처리 파이프라인을 만드는 방법을 배우겠습니다. 하지만 먼저 제너레이터가 무엇인지 이해해 봅시다. 제너레이터는 Python 에서 특별한 유형의 이터레이터입니다. 모든 데이터를 한 번에 메모리에 로드할 수 있는 일반 이터레이터와 달리, 제너레이터는 필요에 따라 값을 생성합니다. 이는 대량의 데이터 스트림을 처리할 때 메모리를 절약하므로 매우 유용합니다. 전체 데이터 세트를 메모리에 저장하는 대신, 제너레이터는 필요에 따라 값을 하나씩 생성합니다.

## 제너레이터 이해

제너레이터는 본질적으로 이터레이터를 반환하는 함수입니다. 이 이터레이터를 반복하면 일련의 값이 생성됩니다. 제너레이터 함수를 작성하는 방법은 일반 함수와 유사하지만 중요한 차이점이 있습니다. `return` 문 대신 제너레이터 함수는 `yield` 문을 사용합니다. `yield` 문은 고유한 동작을 합니다. 함수를 일시 중지하고 현재 상태를 저장합니다. 다음 값을 요청하면 함수는 중단된 지점부터 계속됩니다. 이를 통해 제너레이터는 매번 처음부터 시작하지 않고도 값을 점진적으로 생성할 수 있습니다.

## follow() 함수 사용

이전에 생성한 `follow()` 함수는 Unix 의 `tail -f` 명령과 유사하게 작동합니다. `tail -f` 명령은 파일의 새 콘텐츠를 지속적으로 모니터링하며, `follow()` 함수도 마찬가지입니다. 이제 이를 사용하여 간단한 처리 파이프라인을 만들어 보겠습니다.

### 1 단계: 새 터미널 창 열기

먼저 WebIDE 에서 새 터미널 창을 엽니다. `Terminal → New Terminal`로 이동하여 이 작업을 수행할 수 있습니다. 이 새 터미널은 Python 명령을 실행할 곳입니다.

### 2 단계: Python 대화형 셸 시작

새 터미널이 열리면 Python 대화형 셸을 시작합니다. 터미널에 다음 명령을 입력하여 이 작업을 수행할 수 있습니다.

```bash
python3
```

Python 대화형 셸을 사용하면 Python 코드를 한 줄씩 실행하고 결과를 즉시 확인할 수 있습니다.

### 3 단계: `follow` 함수를 가져오고 파이프라인 설정

이제 `follow` 함수를 가져와 주식 데이터를 읽기 위한 기본 파이프라인을 설정합니다. Python 대화형 셸에서 다음 코드를 입력합니다.

```python
>>> from follow import follow
>>> import csv
>>> lines = follow('stocklog.csv')
>>> rows = csv.reader(lines)
>>> for row in rows:
...     print(row)
...
```

각 줄의 기능은 다음과 같습니다.

- `from follow import follow`: `follow` 모듈에서 `follow` 함수를 가져옵니다.
- `import csv`: Python 에서 CSV 파일을 읽고 쓰기 위해 사용되는 `csv` 모듈을 가져옵니다.
- `lines = follow('stocklog.csv')`: 파일 이름 `stocklog.csv`로 `follow` 함수를 호출합니다. `follow` 함수는 파일에 새 줄이 추가될 때마다 생성되는 제너레이터를 반환합니다.
- `rows = csv.reader(lines)`: `csv.reader()` 함수는 `follow` 함수에서 생성된 줄을 가져와 CSV 데이터의 행으로 구문 분석합니다.
- `for` 루프는 이러한 행을 반복하고 각 행을 인쇄합니다.

### 4 단계: 출력 확인

코드를 실행한 후 다음과 유사한 출력을 볼 수 있습니다 (데이터는 다를 수 있음).

```
['BA', '98.35', '6/11/2007', '09:41.07', '0.16', '98.25', '98.35', '98.31', '158148']
['AA', '39.63', '6/11/2007', '09:41.07', '-0.03', '39.67', '39.63', '39.31', '270224']
['XOM', '82.45', '6/11/2007', '09:41.07', '-0.23', '82.68', '82.64', '82.41', '748062']
['PG', '62.95', '6/11/2007', '09:41.08', '-0.12', '62.80', '62.97', '62.61', '454327']
...
```

이 출력은 데이터 파이프라인을 성공적으로 생성했음을 나타냅니다. `follow()` 함수는 파일에서 줄을 생성하고, 이러한 줄은 `csv.reader()` 함수로 전달되어 데이터 행으로 구문 분석됩니다.

출력이 충분히 표시되면 `Ctrl+C`를 눌러 실행을 중지할 수 있습니다.

## 무슨 일이 일어나고 있나요?

이 파이프라인에서 무슨 일이 일어나고 있는지 자세히 살펴보겠습니다.

1. `follow('stocklog.csv')`는 제너레이터를 생성합니다. 이 제너레이터는 `stocklog.csv` 파일을 추적하고 파일에 새 줄이 추가될 때마다 생성합니다.
2. `csv.reader(lines)`는 `follow` 함수에서 생성된 줄을 가져와 CSV 행 데이터로 구문 분석합니다. CSV 파일의 구조를 이해하고 줄을 개별 값으로 분할합니다.
3. 그런 다음 `for` 루프는 이러한 행을 반복하여 각 행을 인쇄합니다. 이를 통해 데이터를 읽을 수 있는 형식으로 볼 수 있습니다.

이것은 제너레이터를 사용한 데이터 처리 파이프라인의 간단한 예입니다. 다음 단계에서는 더 복잡하고 유용한 파이프라인을 구축할 것입니다.
