# Тестирование на возникновение исключений

Тестирование является важной частью разработки программного обеспечения, и одним из важных аспектов этого процесса является обеспечение правильной обработки ошибочных ситуаций в вашем коде. В Python модуль `unittest` предоставляет удобный способ проверить, возникают ли конкретные исключения, как ожидается.

1. Откройте файл `teststock.py`. Мы добавим несколько тестовых методов, которые предназначены для проверки возникновения исключений. Эти тесты помогут нам убедиться, что наш код ведет себя правильно при встрече с некорректными входными данными.

```python
def test_shares_type(self):
    s = stock.Stock('GOOG', 100, 490.1)
    with self.assertRaises(TypeError):
        s.shares = '50'

def test_shares_value(self):
    s = stock.Stock('GOOG', 100, 490.1)
    with self.assertRaises(ValueError):
        s.shares = -50

def test_price_type(self):
    s = stock.Stock('GOOG', 100, 490.1)
    with self.assertRaises(TypeError):
        s.price = '490.1'

def test_price_value(self):
    s = stock.Stock('GOOG', 100, 490.1)
    with self.assertRaises(ValueError):
        s.price = -490.1

def test_attribute_error(self):
    s = stock.Stock('GOOG', 100, 490.1)
    with self.assertRaises(AttributeError):
        s.share = 100  # 'share' is incorrect, should be 'shares'
```

Теперь разберемся, как работают эти тесты на возникновение исключений.

- Оператор `with self.assertRaises(ExceptionType):` создает менеджер контекста. Этот менеджер контекста проверяет, вызывает ли код внутри блока `with` указанное исключение.
- Если ожидаемое исключение возникает внутри блока `with`, тест проходит успешно. Это означает, что наш код правильно определяет некорректные входные данные и вызывает соответствующую ошибку.
- Если исключение не возникает или возникает другое исключение, тест завершается неудачно. Это показывает, что наш код, возможно, не обрабатывает некорректные входные данные так, как ожидалось.

Эти тесты предназначены для проверки следующих сценариев:

- Установка атрибута `shares` в строку должна вызвать исключение `TypeError`, так как `shares` должен быть числом.
- Установка атрибута `shares` в отрицательное число должна вызвать исключение `ValueError`, так как количество акций не может быть отрицательным.
- Установка атрибута `price` в строку должна вызвать исключение `TypeError`, так как `price` должен быть числом.
- Установка атрибута `price` в отрицательное число должна вызвать исключение `ValueError`, так как цена не может быть отрицательной.
- Попытка установить несуществующий атрибут `share` (обратите внимание на отсутствие буквы 's') должна вызвать исключение `AttributeError`, так как правильное имя атрибута - `shares`.

2. После добавления этих тестовых методов сохраните файл `teststock.py`. Затем запустите все тесты, используя следующую команду в терминале:

```bash
python3 teststock.py
```

Если все работает правильно, вы должны увидеть вывод, показывающий, что все 12 тестов прошли успешно. Вывод будет выглядеть следующим образом:

```
............
----------------------------------------------------------------------
Ran 12 tests in 0.002s

OK
```

Двенадцать точек представляют все тесты, которые вы написали до сих пор. Было 7 тестов из предыдущего шага, и мы только что добавили 5 новых. Этот вывод показывает, что ваш код обрабатывает исключения как ожидается, что является хорошим признаком хорошо протестированной программы.
