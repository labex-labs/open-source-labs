# 运行选定的测试并使用测试发现功能

Python 中的 `unittest` 模块是一个强大的工具，可让你有效地测试代码。它提供了多种方式来运行特定的测试，或者自动发现并运行项目中的所有测试。这非常有用，因为它能帮助你在测试时专注于代码的特定部分，或者快速检查整个项目的测试套件。

## 运行特定的测试

有时，你可能只想运行特定的测试方法或测试类，而不是整个测试套件。你可以通过在 `unittest` 模块中使用模式选项来实现这一点。这能让你更好地控制执行哪些测试，在调试代码的特定部分时非常方便。

1. 若要仅运行与创建 `Stock` 对象相关的测试：

```bash
python3 -m unittest teststock.TestStock.test_create
```

在这个命令中，`python3 -m unittest` 告诉 Python 运行 `unittest` 模块。`teststock` 是测试文件的名称，`TestStock` 是测试类的名称，`test_create` 是我们想要运行的特定测试方法。通过运行这个命令，你可以快速检查与创建 `Stock` 对象相关的代码是否按预期工作。

2. 若要运行 `TestStock` 类中的所有测试：

```bash
python3 -m unittest teststock.TestStock
```

在这里，我们省略了具体的测试方法名称。因此，这个命令将执行 `teststock` 文件中 `TestStock` 类内的所有测试方法。当你想检查 `Stock` 对象测试用例的整体功能时，这很有用。

## 使用测试发现功能

`unittest` 模块可以自动发现并运行项目中的所有测试文件。这省去了你手动指定每个要运行的测试文件的麻烦，特别是在有许多测试文件的大型项目中。

1. 重命名当前文件以遵循测试发现的命名模式：

```bash
mv teststock.py test_stock.py
```

`unittest` 中的测试发现机制会查找遵循 `test_*.py` 命名模式的文件。通过将文件重命名为 `test_stock.py`，我们让 `unittest` 模块更容易找到并运行该文件中的测试。

2. 运行测试发现：

```bash
python3 -m unittest discover
```

这个命令告诉 `unittest` 模块自动发现并运行当前目录中所有符合 `test_*.py` 模式的测试文件。它会遍历目录并执行在匹配文件中找到的所有测试用例。

3. 你还可以指定一个目录来搜索测试：

```bash
python3 -m unittest discover -s . -p "test_*.py"
```

其中：

- `-s .` 指定开始发现测试的目录（在这种情况下是当前目录）。点号 (`.`) 表示当前目录。如果你想在其他位置搜索测试，可以将其更改为其他目录路径。
- `-p "test_*.py"` 是匹配测试文件的模式。这确保只有以 `test_` 开头且扩展名为 `.py` 的文件才会被视为测试文件。

你应该会看到和之前一样，所有 12 个测试都运行并通过了。

4. 为了与实验保持一致，将文件重命名回原来的名称：

```bash
mv test_stock.py teststock.py
```

运行测试发现后，我们将文件重命名回原来的名称，以保持实验环境的一致性。

通过使用测试发现功能，你可以轻松运行项目中的所有测试，而无需单独指定每个测试文件。这使测试过程更高效，也更不容易出错。
