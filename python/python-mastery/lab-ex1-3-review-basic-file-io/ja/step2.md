# ファイルの開きと読み取り

このステップでは、Python でファイルを開いて読み取る方法を学びます。ファイル入出力 (I/O) は、プログラミングにおける基本的な概念です。これにより、プログラムがテキストファイルや CSV ファイルなどの外部ファイルとやり取りできるようになります。Python でファイルを扱う最も一般的な方法の 1 つは、`open()` 関数を使用することです。

`open()` 関数は、Python でファイルを開くために使用されます。この関数には 2 つの重要な引数が必要です。最初の引数は、開きたいファイルの名前です。2 番目の引数は、ファイルを開くモードです。ファイルを読み取りたい場合は、'r' モードを使用します。これは、Python に対してファイルの内容を読み取るだけで、ファイルに何らかの変更を加えないことを伝えます。

それでは、`pcost.py` ファイルにコードを追加して、`portfolio.dat` ファイルを開いて読み取りましょう。コードエディタで `pcost.py` ファイルを開き、以下のコードを追加します。

```python
# pcost.py
# 株式ポートフォリオの総コストを計算する

def portfolio_cost(filename):
    """
    ポートフォリオファイルの総コスト (株式数 * 価格) を計算する
    """
    total_cost = 0.0

    # ファイルを開く
    with open(filename, 'r') as file:
        # ファイル内のすべての行を読み取る
        for line in file:
            print(line)  # デバッグ用、読み取っている内容を確認するため

    # 総コストを返す
    return total_cost

# ポートフォリオファイルを引数にして関数を呼び出す
total_cost = portfolio_cost('portfolio.dat')
print(f'総コスト: ${total_cost}')
```

このコードが何をするかを分解してみましょう。

1. まず、`portfolio_cost()` という名前の関数を定義します。この関数は、ファイル名を入力パラメータとして受け取ります。この関数の目的は、ファイル内のデータに基づいて株式ポートフォリオの総コストを計算することです。
2. 関数の内部で、`open()` 関数を使用して指定されたファイルを読み取りモードで開きます。`with` 文を使用することで、ファイルの読み取りが終了した後にファイルが適切に閉じられることを保証します。これは、リソースのリークを避けるための良い習慣です。
3. 次に、`for` ループを使用してファイルを一行ずつ読み取ります。ファイルの各行について、その行を表示します。これはデバッグ目的で行っているだけで、ファイルから読み取っているデータを確認するためです。
4. ファイルの読み取りが終了した後、関数は総コストを返します。現在、総コストは 0.0 に設定されています。これは、実際の計算をまだ実装していないためです。
5. 関数の外で、`portfolio_cost()` 関数を 'portfolio.dat' というファイル名で呼び出します。これは、関数に対して `portfolio.dat` ファイル内のデータに基づいて総コストを計算するように要求しています。
6. 最後に、f-string を使用して総コストを表示します。

それでは、このコードを実行して、何が起こるかを見てみましょう。ターミナルで以下のコマンドを使用して Python ファイルを実行できます。

```bash
python3 ~/project/pcost.py
```

このコマンドを実行すると、`portfolio.dat` ファイルの各行がターミナルに表示され、その後に現在 0.0 に設定されている総コストが表示されるはずです。この出力により、ファイルが正しく読み取られていることを確認できます。
