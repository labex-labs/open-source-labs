# Использование функций `enumerate()` и `zip()`

В этом шаге мы рассмотрим две чрезвычайно полезные встроенные функции в Python, которые являются важными для итерации: `enumerate()` и `zip()`. Эти функции могут значительно упростить ваш код при работе с последовательностями.

## Подсчет с использованием `enumerate()`

При итерации по последовательности вам часто может понадобиться отслеживать индекс или позицию каждого элемента. Именно здесь функция `enumerate()` пригодится. Функция `enumerate()` принимает последовательность в качестве входных данных и возвращает пары (индекс, значение) для каждого элемента в этой последовательности.

Если вы следовали инструкциям в интерпретаторе Python из предыдущего шага, вы можете продолжить использовать его. Если нет, запустите новую сессию. Вот как вы можете подготовить данные, если вы начинаете с чистого листа:

```python
# If you're starting a new session, reload the data first:
# import csv
# f = open('portfolio.csv')
# f_csv = csv.reader(f)
# headers = next(f_csv)
# rows = list(f_csv)

# Use enumerate to get row numbers
for rowno, row in enumerate(rows):
    print(rowno, row)
```

При запуске вышеуказанного кода функция `enumerate(rows)` сгенерирует пары индекса (начиная с 0) и соответствующей строки из последовательности `rows`. Затем цикл `for` распакует эти пары в переменные `rowno` и `row`, и мы выведем их на экран.

Вывод:

```
0 ['AA', '100', '32.20']
1 ['IBM', '50', '91.10']
2 ['CAT', '150', '83.44']
3 ['MSFT', '200', '51.23']
4 ['GE', '95', '40.37']
5 ['MSFT', '50', '65.10']
6 ['IBM', '100', '70.44']
```

Мы можем сделать код еще более читаемым, объединив `enumerate()` с распаковкой. Распаковка позволяет нам напрямую присваивать элементы последовательности отдельным переменным.

```python
for rowno, (name, shares, price) in enumerate(rows):
    print(rowno, name, shares, price)
```

В этом коде мы используем дополнительную пару скобок вокруг `(name, shares, price)` для правильной распаковки данных строки. Функция `enumerate(rows)` по-прежнему возвращает индекс и строку, но теперь мы распаковываем строку в переменные `name`, `shares` и `price`.

Вывод:

```
0 AA 100 32.20
1 IBM 50 91.10
2 CAT 150 83.44
3 MSFT 200 51.23
4 GE 95 40.37
5 MSFT 50 65.10
6 IBM 100 70.44
```

## Сопоставление данных с использованием `zip()`

Функция `zip()` - еще один мощный инструмент в Python. Она используется для объединения соответствующих элементов из нескольких последовательностей. Когда вы передаете несколько последовательностей в `zip()`, она создает итератор, который генерирует кортежи, где каждый кортеж содержит элементы из каждой входной последовательности на одной и той же позиции.

Давайте посмотрим, как мы можем использовать `zip()` с данными `headers` и `row`, с которыми мы работали.

```python
# Recall the headers variable from earlier
print(headers)  # Should show ['name', 'shares', 'price']

# Get the first row
row = rows[0]
print(row)      # Should show ['AA', '100', '32.20']

# Use zip to pair column names with values
for col, val in zip(headers, row):
    print(col, val)
```

В этом коде `zip(headers, row)` берет последовательность `headers` и последовательность `row` и сопоставляет их соответствующие элементы. Затем цикл `for` распакует эти пары в `col` (для названия столбца из `headers`) и `val` (для значения из `row`), и мы выведем их на экран.

Вывод:

```
['name', 'shares', 'price']
['AA', '100', '32.20']
name AA
shares 100
price 32.20
```

Один из самых распространенных применений `zip()` - создание словарей из пар ключ - значение. В Python словарь - это коллекция пар ключ - значение.

```python
# Create a dictionary from headers and row values
record = dict(zip(headers, row))
print(record)
```

Здесь `zip(headers, row)` создает пары названий столбцов и значений, а функция `dict()` берет эти пары и преобразует их в словарь.

Вывод:

```
{'name': 'AA', 'shares': '100', 'price': '32.20'}
```

Мы можем расширить эту идею и преобразовать все строки в нашей последовательности `rows` в словари.

```python
# Convert all rows to dictionaries
for row in rows:
    record = dict(zip(headers, row))
    print(record)
```

В этом цикле для каждой строки в `rows` мы используем `zip(headers, row)` для создания пар ключ - значение, а затем `dict()` для преобразования этих пар в словарь. Эта техника очень распространена в приложениях для обработки данных, особенно при работе с CSV-файлами, где первая строка содержит заголовки.

Вывод:

```
{'name': 'AA', 'shares': '100', 'price': '32.20'}
{'name': 'IBM', 'shares': '50', 'price': '91.10'}
{'name': 'CAT', 'shares': '150', 'price': '83.44'}
{'name': 'MSFT', 'shares': '200', 'price': '51.23'}
{'name': 'GE', 'shares': '95', 'price': '40.37'}
{'name': 'MSFT', 'shares': '50', 'price': '65.10'}
{'name': 'IBM', 'shares': '100', 'price': '70.44'}
```
