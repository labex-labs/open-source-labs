# Понимание переменных класса и методов класса

В этом первом шаге мы углубимся в концепции переменных класса и методов класса в Python. Это важные концепции, которые помогут вам писать более эффективный и организованный код. Прежде чем мы начнем работать с переменными класса и методами класса, давайте сначала посмотрим, как в настоящее время создаются экземпляры нашего класса `Stock`. Это даст нам базовое понимание и покажет, где мы можем внести улучшения.

## Что такое переменные класса?

Переменные класса - это особый тип переменных в Python. Они общие для всех экземпляров класса. Чтобы лучше понять это, давайте сравним их с переменными экземпляра. Переменные экземпляра уникальны для каждого экземпляра класса. Например, если у вас есть несколько экземпляров класса, каждый экземпляр может иметь свое собственное значение для переменной экземпляра. С другой стороны, переменные класса определяются на уровне класса. Это означает, что все экземпляры этого класса могут получить доступ к и разделять одно и то же значение переменной класса.

## Что такое методы класса?

Методы класса - это методы, которые работают с самим классом, а не с отдельными экземплярами класса. Они привязаны к классу, что означает, что их можно вызывать напрямую на классе без создания экземпляра. Чтобы определить метод класса в Python, мы используем декоратор `@classmethod`. И вместо того, чтобы принимать экземпляр (`self`) в качестве первого параметра, методы класса принимают класс (`cls`) в качестве своего первого параметра. Это позволяет им работать с данными на уровне класса и выполнять действия, связанные с классом в целом.

## Текущий подход к созданию экземпляров Stock

Давайте сначала посмотрим, как мы в настоящее время создаем экземпляры класса `Stock`. Откройте файл `stock.py` в редакторе, чтобы посмотреть текущую реализацию:

```python
class Stock:
    def __init__(self, name, shares, price):
        self.name = name
        self.shares = shares
        self.price = price

    def cost(self):
        return self.shares * self.price
```

Экземпляры этого класса обычно создаются одним из следующих способов:

1. Прямая инициализация значениями:

   ```python
   s = Stock('GOOG', 100, 490.1)
   ```

   Здесь мы напрямую создаем экземпляр класса `Stock`, предоставляя значения для атрибутов `name`, `shares` и `price`. Это простой способ создания экземпляра, когда вы заранее знаете значения.

2. Создание из данных, прочитанных из CSV-файла:
   ```python
   import csv
   with open('portfolio.csv') as f:
       rows = csv.reader(f)
       headers = next(rows)  # Пропустить заголовок
       row = next(rows)      # Получить первую строку данных
       s = Stock(row[0], int(row[1]), float(row[2]))
   ```
   Когда мы читаем данные из CSV-файла, значения изначально имеют строковый формат. Поэтому при создании экземпляра `Stock` из данных CSV нам нужно вручную преобразовать строковые значения в соответствующие типы. Например, значение `shares` нужно преобразовать в целое число, а значение `price` - в число с плавающей точкой.

Давайте попробуем это. Создайте новый Python-файл с именем `test_stock.py` в директории `~/project` со следующим содержимым:

```python
# test_stock.py
from stock import Stock
import csv

# Метод 1: Прямое создание
s1 = Stock('GOOG', 100, 490.1)
print(f"Stock: {s1.name}, Shares: {s1.shares}, Price: {s1.price}")
print(f"Cost: {s1.cost()}")

# Метод 2: Создание из строки CSV
with open('portfolio.csv') as f:
    rows = csv.reader(f)
    headers = next(rows)  # Пропустить заголовок
    row = next(rows)      # Получить первую строку данных
    s2 = Stock(row[0], int(row[1]), float(row[2]))
    print(f"\nStock from CSV: {s2.name}, Shares: {s2.shares}, Price: {s2.price}")
    print(f"Cost: {s2.cost()}")
```

Запустите этот файл, чтобы увидеть результаты:

```bash
cd ~/project
python test_stock.py
```

Вы должны увидеть вывод, похожий на следующий:

```
Stock: GOOG, Shares: 100, Price: 490.1
Cost: 49010.0

Stock from CSV: AA, Shares: 100, Price: 32.2
Cost: 3220.0
```

Эта ручная конвертация работает, но имеет некоторые недостатки. Мы должны знать точный формат данных, и мы должны выполнять конвертации каждый раз, когда создаем экземпляр из данных CSV. Это может быть ошибочным и затратным по времени. В следующем шаге мы создадим более элегантное решение с использованием методов класса.
