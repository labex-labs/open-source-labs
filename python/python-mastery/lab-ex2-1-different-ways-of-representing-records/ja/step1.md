# データセットの探索

まずは、今回取り扱うデータセットを詳しく見ていきましょう。`ctabus.csv` ファイルは CSV (Comma-Separated Values、カンマ区切り値) ファイルです。CSV ファイルは表形式のデータを格納する一般的な方法で、各行が 1 つのレコードを表し、レコード内の値はカンマで区切られています。この特定のファイルには、2001 年 1 月 1 日から 2013 年 8 月 31 日までのシカゴ交通局 (Chicago Transit Authority, CTA) バスシステムの日々の乗車人数データが含まれています。

このファイルの構造を理解するために、まずは中身をのぞいてみましょう。Python を使ってファイルを読み込み、いくつかの行を出力します。ターミナルを開き、以下の Python コードを実行してください。

```python
f = open('/home/labex/project/ctabus.csv')
print(next(f))  # ヘッダー行を読み込む
print(next(f))  # 最初のデータ行を読み込む
print(next(f))  # 2 番目のデータ行を読み込む
f.close()
```

このコードでは、まず `open` 関数を使ってファイルを開き、変数 `f` に割り当てます。`next` 関数はファイルから次の行を読み込むために使用されます。これを 3 回使用します。最初はヘッダー行を読み込み、通常はデータセットの列名が含まれています。2 回目と 3 回目はそれぞれ最初と 2 番目のデータ行を読み込みます。最後に、`close` メソッドを使ってファイルを閉じ、システムリソースを解放します。

以下のような出力が表示されるはずです。

```
route,date,daytype,rides

3,01/01/2001,U,7354

4,01/01/2001,U,9288
```

この出力から、ファイルには 4 列のデータがあることがわかります。各列が表す内容を分解してみましょう。

1. `route`：これはバス路線の名前または番号です。データセットの最初の列 (列 0) です。
2. `date`：MM/DD/YYYY 形式の日付文字列です。これは 2 番目の列 (列 1) です。
3. `daytype`：曜日タイプのコードで、3 番目の列 (列 2) です。
   - U = 日曜日/祝日
   - A = 土曜日
   - W = 平日
4. `rides`：この列には、整数として乗車人数の合計が記録されています。4 番目の列 (列 3) です。

`rides` 列は、特定の日に特定の路線のバスに乗車した人数を示します。たとえば、上記の出力から、2001 年 1 月 1 日に 3 番のバスに 7,354 人が乗車したことがわかります。

では、ファイルに何行あるかを調べてみましょう。行数を知ることで、データセットのサイズの目安がつきます。以下の Python コードを実行してください。

```python
with open('/home/labex/project/ctabus.csv') as f:
    line_count = sum(1 for line in f)
    print(f"Total lines in the file: {line_count}")
```

このコードでは、`with` 文を使ってファイルを開きます。`with` を使用する利点は、処理が終了したときに自動的にファイルを閉じてくれることです。次に、ジェネレータ式 `(1 for line in f)` を使って、ファイル内の各行に対して 1 のシーケンスを作成します。`sum` 関数はこれらの 1 をすべて合計し、ファイル内の総行数を求めます。最後に、結果を出力します。

これにより、およそ 577,564 行という出力が得られるはずです。つまり、かなり大きなデータセットを扱っていることになります。この大規模なデータセットを使って、多くのデータを分析し、洞察を得ることができます。
