# データセットの探索

まず、これから扱うデータセットを詳しく見ていきましょう。ファイル `ctabus.csv` は CSV (Comma-Separated Values, カンマ区切り値) 形式のファイルです。CSV ファイルは、各行が 1 つのレコードを表し、行内の値がカンマで区切られた表形式のデータを保存する一般的な方法です。この特定のファイルには、2001 年 1 月 1 日から 2013 年 8 月 31 日までのシカゴ交通局 (CTA) のバスシステムの 1 日ごとの乗車データが格納されています。

ファイルを解凍し、zip ファイルを削除します。

```bash
cd /home/labex/project
unzip ctabus.csv.zip
rm ctabus.csv.zip
```

このファイルの構造を理解するために、まず中身を覗いてみましょう。Python を使用してファイルを読み込み、いくつかの行を出力します。ターミナルを開き、次の Python コードを実行します。

```python
f = open('/home/labex/project/ctabus.csv')
print(next(f))  # ヘッダー行を読み込む
print(next(f))  # 最初のデータ行を読み込む
print(next(f))  # 2 番目のデータ行を読み込む
f.close()
```

このコードでは、まず `open` 関数を使用してファイルを開き、変数 `f` に割り当てます。`next` 関数は、ファイルから次の行を読み取るために使用されます。これを 3 回使用します。最初はヘッダー行を読み取るためです。ヘッダー行には通常、データセット内の列の名前が含まれています。2 回目と 3 回目は、それぞれ最初と 2 番目のデータ行を読み取ります。最後に、`close` メソッドを使用してファイルを閉じ、システムリソースを解放します。

次のような出力が表示されるはずです。

```
route,date,daytype,rides

3,01/01/2001,U,7354

4,01/01/2001,U,9288
```

この出力は、ファイルに 4 つのデータ列があることを示しています。各列が何を表しているかを詳しく見てみましょう。

1. `route`: これはバスの路線名または番号です。データセットの最初の列 (Column 0) です。
2. `date`: これは MM/DD/YYYY 形式の日付文字列です。これは 2 番目の列 (Column 1) です。
3. `daytype`: これは曜日コードで、3 番目の列 (Column 2) です。
   - U = 日曜日/祝日 (Sunday/Holiday)
   - A = 土曜日 (Saturday)
   - W = 平日 (Weekday)
4. `rides`: この列は、乗客の総数を整数として記録します。これは 4 番目の列 (Column 3) です。

`rides` 列は、特定の日の特定の路線でバスに乗車した人数を示しています。たとえば、上記の出力から、2001 年 1 月 1 日に 7,354 人が 3 番のバスに乗車したことがわかります。

次に、ファイル内の行数を確認しましょう。行数を知ることで、データセットのサイズを把握できます。次の Python コードを実行します。

```python
with open('/home/labex/project/ctabus.csv') as f:
    line_count = sum(1 for line in f)
    print(f"Total lines in the file: {line_count}")
```

このコードでは、`with` ステートメントを使用してファイルを開きます。`with` を使用する利点は、処理が完了すると自動的にファイルを閉じることです。次に、ジェネレーター式 `(1 for line in f)` を使用して、ファイル内の各行に対して 1 のシーケンスを作成します。`sum` 関数は、これらの 1 をすべて合計して、ファイル内の行の総数を求めます。最後に、結果を出力します。

これにより、約 577,564 行が出力されるはずです。これは、かなりの量のデータセットを扱っていることを意味します。この大規模なデータセットは、分析して洞察を得るための十分なデータを提供してくれます。
