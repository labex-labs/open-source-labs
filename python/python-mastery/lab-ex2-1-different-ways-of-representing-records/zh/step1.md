# 探索数据集

让我们先仔细看看要处理的数据集，开启这次的学习之旅。文件 `ctabus.csv` 是一个 CSV（逗号分隔值，Comma-Separated Values）文件。CSV 文件是存储表格数据的常用方式，每行代表一条记录，行内的值用逗号分隔。这个特定的文件包含了芝加哥交通管理局（Chicago Transit Authority，CTA）公交系统从 2001 年 1 月 1 日到 2013 年 8 月 31 日的每日乘客数据。

为了了解这个文件的结构，我们先查看一下文件内容。我们将使用 Python 读取文件并打印出几行。打开终端并运行以下 Python 代码：

```python
f = open('/home/labex/project/ctabus.csv')
print(next(f))  # 读取标题行
print(next(f))  # 读取第一行数据
print(next(f))  # 读取第二行数据
f.close()
```

在这段代码中，我们首先使用 `open` 函数打开文件，并将其赋值给变量 `f`。`next` 函数用于从文件中读取下一行。我们使用了三次 `next` 函数：第一次读取标题行，标题行通常包含数据集中各列的名称；第二和第三次分别读取第一行和第二行数据。最后，我们使用 `close` 方法关闭文件，以释放系统资源。

你应该会看到类似以下的输出：

```
route,date,daytype,rides

3,01/01/2001,U,7354

4,01/01/2001,U,9288
```

这个输出表明文件有 4 列数据。下面我们来详细分析每列的含义：

1. `route`：这是公交线路名称或编号，是数据集中的第一列（第 0 列）。
2. `date`：它是一个格式为 MM/DD/YYYY 的日期字符串，是第二列（第 1 列）。
3. `daytype`：这是日期类型代码，是第三列（第 2 列）。
   - U = 周日/节假日
   - A = 周六
   - W = 工作日
4. `rides`：该列以整数形式记录了乘客总数，是第四列（第 3 列）。

`rides` 列告诉我们在特定日期，特定线路上有多少人乘坐了公交车。例如，从上面的输出可以看出，2001 年 1 月 1 日有 7354 人乘坐了 3 路公交车。

现在，让我们来确定文件中有多少行。了解行数可以让我们对数据集的大小有一个概念。运行以下 Python 代码：

```python
with open('/home/labex/project/ctabus.csv') as f:
    line_count = sum(1 for line in f)
    print(f"Total lines in the file: {line_count}")
```

在这段代码中，我们使用 `with` 语句打开文件。使用 `with` 的好处是，当我们处理完文件后，它会自动关闭文件。然后，我们使用生成器表达式 `(1 for line in f)` 为文件中的每一行生成一个 1。`sum` 函数将所有这些 1 相加，从而得到文件中的总行数。最后，我们打印出结果。

输出结果大约为 577564 行，这意味着我们要处理的是一个相当大的数据集。这个大型数据集将为我们提供大量的数据进行分析并从中获取有价值的信息。
