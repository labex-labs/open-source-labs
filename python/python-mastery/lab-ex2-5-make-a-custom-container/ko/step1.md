# 리스트 메모리 할당 이해

Python 에서 리스트는 특히 요소를 추가해야 할 때 매우 유용한 데이터 구조입니다. Python 리스트는 추가 연산에 효율적으로 설계되었습니다. Python 은 필요한 메모리 양을 정확히 할당하는 대신, 향후 추가를 예상하여 추가 메모리를 할당합니다. 이 전략은 리스트가 증가할 때 필요한 메모리 재할당 횟수를 최소화합니다.

`sys.getsizeof()` 함수를 사용하여 이 개념을 더 잘 이해해 봅시다. 이 함수는 객체의 크기를 바이트 단위로 반환하므로, 리스트가 다양한 단계에서 얼마나 많은 메모리를 사용하는지 확인할 수 있습니다.

1. 먼저, 터미널에서 Python 대화형 셸을 열어야 합니다. 이것은 Python 코드를 즉시 실행할 수 있는 놀이터와 같습니다. 열려면 터미널에 다음 명령을 입력하고 Enter 키를 누르십시오.

```bash
python3
```

2. Python 대화형 셸에 들어가면 `sys` 모듈을 가져와야 합니다. Python 의 모듈은 유용한 함수를 포함하는 도구 상자와 같습니다. `sys` 모듈에는 필요한 `getsizeof()` 함수가 있습니다. 모듈을 가져온 후 `items`라는 빈 리스트를 만듭니다. 다음은 이를 수행하는 코드입니다.

```python
import sys
items = []
```

3. 이제 빈 리스트의 초기 크기를 확인해 보겠습니다. `sys.getsizeof()` 함수를 `items` 리스트를 인수로 사용하여 사용합니다. Python 대화형 셸에 다음 코드를 입력하고 Enter 키를 누르십시오.

```python
sys.getsizeof(items)
```

`64` 바이트와 같은 값을 볼 수 있습니다. 이 값은 빈 리스트의 오버헤드를 나타냅니다. 오버헤드는 요소가 없는 경우에도 Python 이 리스트를 관리하는 데 사용하는 기본 메모리 양입니다.

4. 다음으로, 리스트에 항목을 하나씩 추가하고 메모리 할당이 어떻게 변경되는지 관찰합니다. `append()` 메서드를 사용하여 리스트에 요소를 추가한 다음 크기를 다시 확인합니다. 다음은 코드입니다.

```python
items.append(1)
sys.getsizeof(items)
```

약 `96` 바이트 정도의 더 큰 값을 볼 수 있습니다. 이 크기 증가는 Python 이 새 요소를 수용하기 위해 더 많은 메모리를 할당했음을 보여줍니다.

5. 리스트에 더 많은 항목을 계속 추가하고 각 추가 후 크기를 확인해 보겠습니다. 다음은 이를 수행하는 코드입니다.

```python
items.append(2)
sys.getsizeof(items)  # Size remains the same

items.append(3)
sys.getsizeof(items)  # Size still unchanged

items.append(4)
sys.getsizeof(items)  # Size still unchanged

items.append(5)
sys.getsizeof(items)  # Size jumps to a larger value
```

모든 추가 연산마다 크기가 증가하지 않는다는 것을 알 수 있습니다. 대신, 주기적으로 증가합니다. 이는 Python 이 각 새 항목에 대해 개별적으로가 아닌 청크 단위로 메모리를 할당하고 있음을 보여줍니다.

이 동작은 의도된 것입니다. Python 은 리스트가 증가함에 따라 빈번한 재할당을 피하기 위해 처음에 필요한 것보다 더 많은 메모리를 할당합니다. 리스트가 현재 용량을 초과할 때마다 Python 은 더 큰 메모리 청크를 할당합니다.

리스트는 객체 자체를 저장하는 것이 아니라 객체에 대한 참조를 저장한다는 점을 기억하십시오. 64 비트 시스템에서 각 참조는 일반적으로 8 바이트의 메모리가 필요합니다. 이는 리스트가 서로 다른 유형의 객체를 포함할 때 실제로 사용하는 메모리 양에 영향을 미치므로 이해하는 것이 중요합니다.
