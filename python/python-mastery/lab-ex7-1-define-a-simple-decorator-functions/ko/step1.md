# 첫 번째 데코레이터 만들기

## 데코레이터란 무엇인가요?

Python 에서 데코레이터는 초보자에게 매우 유용할 수 있는 특별한 구문입니다. 데코레이터를 사용하면 함수 또는 메서드의 동작을 수정할 수 있습니다. 데코레이터를 다른 함수를 입력으로 받는 함수라고 생각하십시오. 그런 다음 새로운 함수를 반환합니다. 이 새로운 함수는 종종 원래 함수의 동작을 확장하거나 변경합니다.

데코레이터는 `@` 기호를 사용하여 적용됩니다. 이 기호 뒤에 데코레이터 이름을 함수 정의 바로 위에 배치합니다. 이것은 특정 함수에 데코레이터를 사용하려는 것을 Python 에 알리는 간단한 방법입니다.

## 간단한 로깅 데코레이터 만들기

함수가 호출될 때 정보를 기록하는 간단한 데코레이터를 만들어 보겠습니다. 로깅은 실제 응용 프로그램에서 일반적인 작업이며, 이를 위해 데코레이터를 사용하는 것은 데코레이터가 어떻게 작동하는지 이해하는 좋은 방법입니다.

1. 먼저 VSCode 편집기를 엽니다. `/home/labex/project` 디렉토리에서 `logcall.py`라는 새 파일을 만듭니다. 이 파일은 데코레이터 함수를 저장합니다.

2. `logcall.py`에 다음 코드를 추가합니다.

```python
# logcall.py

def logged(func):
    print('Adding logging to', func.__name__)
    def wrapper(*args, **kwargs):
        print('Calling', func.__name__)
        return func(*args, **kwargs)
    return wrapper
```

이 코드가 무엇을 하는지 자세히 살펴보겠습니다.

- `logged` 함수는 데코레이터입니다. 다른 함수 (`func`라고 부름) 를 인수로 받습니다. 이 `func`는 로깅을 추가하려는 함수입니다.
- 데코레이터가 함수에 적용되면 메시지를 출력합니다. 이 메시지는 지정된 이름의 함수에 로깅이 추가되고 있음을 알려줍니다.
- `logged` 함수 내부에서 `wrapper`라는 내부 함수를 정의합니다. 이 `wrapper` 함수가 원래 함수를 대체합니다.
  - 데코레이팅된 함수가 호출되면 `wrapper` 함수는 해당 함수가 호출되고 있음을 알리는 메시지를 출력합니다.
  - 그런 다음 원래 함수 (`func`) 를 해당 함수에 전달된 모든 인수로 호출합니다. `*args` 및 `**kwargs`는 임의의 수의 위치 및 키워드 인수를 허용하는 데 사용됩니다.
  - 마지막으로 원래 함수의 결과를 반환합니다.
- `logged` 함수는 `wrapper` 함수를 반환합니다. 이 `wrapper` 함수는 이제 원래 함수 대신 사용되어 로깅 기능을 추가합니다.

## 데코레이터 사용하기

3. 이제 동일한 디렉토리 (`/home/labex/project`) 에서 다음 코드를 사용하여 `sample.py`라는 다른 파일을 만듭니다.

```python
# sample.py

from logcall import logged

@logged
def add(x, y):
    return x + y

@logged
def sub(x, y):
    return x - y
```

여기서 `@logged` 구문은 매우 중요합니다. Python 에게 `logged` 데코레이터를 `add` 및 `sub` 함수에 적용하도록 지시합니다. 따라서 이러한 함수가 호출될 때마다 데코레이터에 의해 추가된 로깅 기능이 실행됩니다.

## 데코레이터 테스트하기

4. 데코레이터를 테스트하려면 VSCode 에서 터미널을 엽니다. 먼저 다음 명령을 사용하여 디렉토리를 프로젝트 디렉토리로 변경합니다.

```bash
cd /home/labex/project
```

그런 다음 Python 인터프리터를 시작합니다.

```bash
python3
```

5. Python 인터프리터에서 `sample` 모듈을 가져와 데코레이팅된 함수를 테스트합니다.

```python
>>> import sample
Adding logging to add
Adding logging to sub
>>> sample.add(3, 4)
Calling add
7
>>> sample.sub(2, 3)
Calling sub
-1
>>> exit()
```

`sample` 모듈을 가져올 때 "Adding logging to..." 메시지가 출력되는 것을 확인하십시오. 이는 모듈을 가져올 때 데코레이터가 적용되기 때문입니다. 데코레이팅된 함수 중 하나를 호출할 때마다 "Calling..." 메시지가 출력됩니다. 이는 데코레이터가 예상대로 작동하고 있음을 보여줍니다.

이 간단한 데코레이터는 데코레이터의 기본 개념을 보여줍니다. 원래 함수의 코드를 변경하지 않고 추가 기능 (이 경우 로깅) 으로 원래 함수를 래핑합니다. 이것은 Python 에서 다양한 시나리오에서 사용할 수 있는 강력한 기능입니다.
