# ジェネレータパイプライン

ジェネレータのこの側面を使って、処理パイプライン（Unix パイプのようなもの）を設定することができます。

_生産者_ → _処理_ → _処理_ → _消費者_

処理パイプには、初期のデータ生産者と、いくつかの中間処理段階と、最終的な消費者があります。

**生産者** → _処理_ → _処理_ → _消費者_

```python
def producer():
 ...
    yield item
 ...
```

生産者は通常、ジェネレータです。ただし、他のシーケンスのリストであってもかまいません。`yield` によってデータがパイプラインに供給されます。

_生産者_ → _処理_ → _処理_ → **消費者**

```python
def consumer(s):
    for item in s:
     ...
```

消費者は for ループです。項目を取得して、それらを使って何かを行います。

_生産者_ → **処理** → **処理** → _消費者_

```python
def processing(s):
    for item in s:
     ...
        yield newitem
     ...
```

中間処理段階は、同時に項目を消費して生成します。データストリームを変更する場合があります。また、フィルタリング（項目を破棄する）もできます。

_生産者_ → _処理_ → _処理_ → _消費者_

```python
def producer():
 ...
    yield item          # `processing` によって受け取られる項目を生成する
 ...

def processing(s):
    for item in s:      # `producer` から来る
     ...
        yield newitem   # 新しい項目を生成する
     ...

def consumer(s):
    for item in s:      # `processing` から来る
     ...
```

パイプラインを設定するコード

```python
a = producer()
b = processing(a)
c = consumer(b)
```

データが異なる関数を通じて徐々に流れることに気付くでしょう。

このエクササイズでは、`stocksim.py` プログラムがまだバックグラウンドで実行されている必要があります。前のエクササイズで書いた `follow()` 関数を使います。
