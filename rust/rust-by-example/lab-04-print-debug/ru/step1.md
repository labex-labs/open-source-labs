# Debug

Все типы, которые хотят использовать функциональность форматирования `std::fmt`, должны иметь реализацию для печати. Автоматические реализации предоставляются только для типов, таких как в библиотеке `std`. Все остальные типы _должны_ быть реализованы вручную каким-то образом.

Трейт `fmt::Debug` делает это очень простым. _Все_ типы могут `derive` (автоматически создать) реализацию `fmt::Debug`. Это не так для `fmt::Display`, которая должна быть реализована вручную.

```rust
// Эта структура не может быть напечатана ни с использованием `fmt::Display`,
// ни с использованием `fmt::Debug`.
struct UnPrintable(i32);

// Атрибут `derive` автоматически создает реализацию,
// необходимую для печати этой `struct` с использованием `fmt::Debug`.
#[derive(Debug)]
struct DebugPrintable(i32);
```

Все типы библиотеки `std` также автоматически могут быть напечатаны с использованием `{:?}`:

```rust
// Создаем реализацию `fmt::Debug` для `Structure`. `Structure`
// - это структура, содержащая единственное поле типа `i32`.
#[derive(Debug)]
struct Structure(i32);

// Помещаем `Structure` внутрь структуры `Deep`. Также делаем ее печатаемой.
#[derive(Debug)]
struct Deep(Structure);

fn main() {
    // Печать с использованием `{:?}` похожа на печать с использованием `{}`.
    println!("{:?} months in a year.", 12);
    println!("{1:?} {0:?} is the {actor:?} name.",
             "Slater",
             "Christian",
             actor="actor's");

    // `Structure` печатаема!
    println!("Now {:?} will print!", Structure(3));

    // Проблема с `derive` заключается в том, что нет контроля над тем,
    // как будут выглядеть результаты. Что если я хочу, чтобы это было просто `7`?
    println!("Now {:?} will print!", Deep(Structure(7)));
}
```

Таким образом, `fmt::Debug` определенно делает тип печатаемым, но жертвует некоторой элегантностью. Rust также предоставляет "красивую печать" с использованием `{:#?}`.

```rust
#[derive(Debug)]
struct Person<'a> {
    name: &'a str,
    age: u8
}

fn main() {
    let name = "Peter";
    let age = 27;
    let peter = Person { name, age };

    // Красивая печать
    println!("{:#?}", peter);
}
```

Можно вручную реализовать `fmt::Display`, чтобы контролировать отображение.
