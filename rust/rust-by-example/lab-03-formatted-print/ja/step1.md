# フォーマット済みの印刷

印刷は、`std::fmt`に定義された一連の「マクロ」によって処理されます。その中には次のものが含まれます。

- `format!`: フォーマット済みのテキストを`String`に書き込む。
- `print!`: `format!`と同じだが、テキストをコンソール（io::stdout）に印刷する。
- `println!`: `print!`と同じだが、改行文字が追加される。
- `eprint!`: `print!`と同じだが、テキストを標準エラー（io::stderr）に印刷する。
- `eprintln!`: `eprint!`と同じだが、改行文字が追加される。

すべてが同じ方法でテキストを解析します。さらに、Rust はコンパイル時にフォーマットの正しさをチェックします。

```rust
fn main() {
    // 一般的に、`{}` は自動的に任意の引数で置き換えられます。これらは文字列化されます。
    println!("{} days", 31);

    // 位置引数を使用することができます。`{}` の中に整数を指定すると、どの追加引数が置き換えられるかが決まります。引数は、フォーマット文字列の直後から 0 から始まります。
    println!("{0}, this is {1}. {1}, this is {0}", "Alice", "Bob");

    // 名前付き引数も使用できます。
    println!("{subject} {verb} {object}",
             object="the lazy dog",
             subject="the quick brown fox",
             verb="jumps over");

    // 異なるフォーマットを指定するには、`:` の後にフォーマット文字を指定します。
    println!("Base 10:               {}",   69420); // 69420
    println!("Base 2 (binary):       {:b}", 69420); // 10000111100101100
    println!("Base 8 (octal):        {:o}", 69420); // 207454
    println!("Base 16 (hexadecimal): {:x}", 69420); // 10f2c
    println!("Base 16 (hexadecimal): {:X}", 69420); // 10F2C

    // 特定の幅でテキストを右寄せすることができます。これは、"    1"を出力します。（空白 4 つと"1"で、合計幅は 5 です。）
    println!("{number:>5}", number=1);

    // 数字を余分なゼロで埋めることができます。
    println!("{number:0>5}", number=1); // 00001
    // そして、符号を反転させることで左寄せにすることができます。これは、"10000"を出力します。
    println!("{number:0<5}", number=1); // 10000

    // フォーマット指定子に名前付き引数を使用するには、`$` を追加します。
    println!("{number:0>width$}", number=1, width=5);

    // Rust は、正しい数の引数が使用されていることを確認します。
    println!("My name is {0}, {1} {0}", "Bond");
    // FIXME ^ 欠けている引数を追加してください："James"

    // `{}` でフォーマットできるのは、fmt::Display を実装している型のみです。ユーザー定義型は、デフォルトで fmt::Display を実装していません。

    #[allow(dead_code)] // 未使用のモジュールに対する警告を抑制する `dead_code` を無効にする
    struct Structure(i32);

    // これはコンパイルされません。なぜなら、`Structure` は fmt::Display を実装していないからです。
    // println!("This struct `{}` won't print...", Structure(3));
    // TODO ^ この行のコメントを外してみてください

    // Rust 1.58 以降では、周囲の変数から直接引数をキャプチャすることができます。上と同じように、これは"    1"を出力します。空白 4 つと"1"です。
    let number: f64 = 1.0;
    let width: usize = 5;
    println!("{number:>width$}");
}
```

`std::fmt`には、テキストの表示を制御する多くの「トレイト」が含まれています。以下に、2 つの重要なトレイトの基本形式を示します。

- `fmt::Debug`: `{:?}`マーカーを使用します。デバッグ目的でテキストをフォーマットします。
- `fmt::Display`: `{}`マーカーを使用します。もっとエレガントでユーザーにやさしい方法でテキストをフォーマットします。

ここでは、`fmt::Display`を使用しました。なぜなら、標準ライブラリがこれらの型に対する実装を提供しているからです。カスタム型のテキストを印刷するには、さらなる手順が必要です。

`fmt::Display`トレイトを実装すると、自動的に`ToString`トレイトが実装されます。これにより、型を`String`に変換することができます。

43 行目の`#[allow(dead_code)]`は、その後のモジュールにのみ適用される\[属性\]です。

## アクティビティ

- 上記のコードの問題を修正してください（FIXME を参照）。エラーなく実行できるようにしてください。
- `Structure`構造体をフォーマットしようとする行のコメントを外してみてください（TODO を参照）。
- 表示する小数桁数を制御して、`Pi is roughly 3.142`を出力する`println!`マクロ呼び出しを追加してください。この演習の目的では、`let pi = 3.141592`を円周率の推定値として使用してください。（ヒント：表示する小数桁数を設定するには、`std::fmt`のドキュメントを確認する必要があるかもしれません。）
