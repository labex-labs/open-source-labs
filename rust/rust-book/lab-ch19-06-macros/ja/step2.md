# マクロと関数の違い

基本的に、マクロは他のコードを書くコードを書く方法であり、これは「メタプログラミング」と呼ばれます。付録 C では、`derive`属性について説明しており、これはあなたに対してさまざまなトレイトの実装を生成します。また、本書を通じて`println!`や`vec!`マクロも使用してきました。これらのマクロはすべて、手動で書いたコードよりも多くのコードを生成するように「展開」されます。

メタプログラミングは、書かなければならないコード量と保守コストを削減するのに役立ち、これは関数の役割の 1 つでもあります。ただし、マクロには関数にはない追加の機能がいくつかあります。

関数のシグネチャは、関数が持つパラメータの数と型を宣言する必要があります。一方、マクロは可変数のパラメータを取ることができます。つまり、1 つの引数で`println!("hello")`を呼び出したり、2 つの引数で`println!("hello {}", name)`を呼び出したりすることができます。また、マクロはコンパイラがコードの意味を解釈する前に展開されるため、例えば、特定の型に対してトレイトを実装することができます。関数はできません。なぜなら、関数は実行時に呼び出され、トレイトはコンパイル時に実装する必要があるからです。

関数の代わりにマクロを実装する欠点は、マクロ定義が関数定義よりも複雑であるということです。なぜなら、あなたが Rust コードを書いているので、それが Rust コードを書くからです。この間接性のため、マクロ定義は一般的に関数定義よりも読みにくく、理解しにくく、保守しにくい傾向があります。

マクロと関数のもう 1 つの重要な違いは、関数はどこで定義してもどこで呼び出してもよいのに対し、マクロはファイル内で呼び出す前に定義するか、スコープに持ち込む必要があるということです。
