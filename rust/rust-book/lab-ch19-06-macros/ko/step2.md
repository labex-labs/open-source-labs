# 매크로와 함수의 차이점

근본적으로 매크로는 다른 코드를 작성하는 코드를 작성하는 방법이며, 이를 *메타 프로그래밍 (metaprogramming)*이라고 합니다. 부록 C 에서 다양한 트레이트 (trait) 의 구현을 생성하는 `derive` 속성에 대해 논의했습니다. 또한 책 전체에서 `println!` 및 `vec!` 매크로를 사용했습니다. 이러한 모든 매크로는 수동으로 작성한 코드보다 더 많은 코드를 생성하도록 *확장 (expand)*됩니다.

메타 프로그래밍은 작성하고 유지 관리해야 하는 코드의 양을 줄이는 데 유용하며, 이는 함수의 역할 중 하나이기도 합니다. 그러나 매크로는 함수가 갖지 못하는 몇 가지 추가적인 기능을 가지고 있습니다.

함수 시그니처 (signature) 는 함수가 갖는 매개변수의 수와 유형을 선언해야 합니다. 반면에 매크로는 가변적인 수의 매개변수를 사용할 수 있습니다. 즉, `println!("hello")`를 하나의 인수로 호출하거나 `println!("hello {}", name)`을 두 개의 인수로 호출할 수 있습니다. 또한 매크로는 컴파일러가 코드의 의미를 해석하기 전에 확장되므로, 예를 들어 매크로는 주어진 타입 (type) 에 대해 트레이트를 구현할 수 있습니다. 함수는 런타임에 호출되고 트레이트는 컴파일 시간에 구현되어야 하므로 불가능합니다.

함수 대신 매크로를 구현하는 단점은 매크로 정의가 함수 정의보다 더 복잡하다는 것입니다. 왜냐하면 Rust 코드를 작성하는 Rust 코드를 작성하기 때문입니다. 이러한 간접성으로 인해 매크로 정의는 일반적으로 함수 정의보다 읽고, 이해하고, 유지 관리하기가 더 어렵습니다.

매크로와 함수의 또 다른 중요한 차이점은 함수와 달리 매크로를 파일에서 호출하기 _전에_ 정의하거나 범위 내로 가져와야 한다는 것입니다. 함수는 어디에서나 정의하고 어디에서나 호출할 수 있습니다.
