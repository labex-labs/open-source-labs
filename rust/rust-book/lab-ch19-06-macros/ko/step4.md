# 속성 (attribute) 에서 코드를 생성하기 위한 절차적 매크로

두 번째 형태의 매크로는 절차적 매크로 (procedural macro) 이며, 이는 함수처럼 작동합니다 (그리고 일종의 절차입니다). *절차적 매크로*는 일부 코드를 입력으로 받아 해당 코드를 조작하고 선언적 매크로가 수행하는 것처럼 패턴과 일치시키고 코드를 다른 코드로 대체하는 대신 일부 코드를 출력으로 생성합니다. 세 가지 종류의 절차적 매크로는 사용자 정의 `derive`, 속성 유사 (attribute-like), 함수 유사 (function-like) 이며, 모두 유사한 방식으로 작동합니다.

절차적 매크로를 생성할 때 정의는 특수한 크레이트 (crate) 유형을 가진 자체 크레이트에 있어야 합니다. 이는 미래에 제거되기를 바라는 복잡한 기술적인 이유 때문입니다. Listing 19-29 에서는 특정 매크로 종류를 사용하는 자리 표시자인 `some_attribute`를 사용하여 절차적 매크로를 정의하는 방법을 보여줍니다.

Filename: `src/lib.rs`

```rust
use proc_macro::TokenStream;

#[some_attribute]
pub fn some_name(input: TokenStream) -> TokenStream {
}
```

Listing 19-29: 절차적 매크로 정의의 예

절차적 매크로를 정의하는 함수는 `TokenStream`을 입력으로 받아 `TokenStream`을 출력으로 생성합니다. `TokenStream` 타입은 Rust 에 포함된 `proc_macro` 크레이트에 의해 정의되며 토큰 시퀀스를 나타냅니다. 이것이 매크로의 핵심입니다. 매크로가 작동하는 소스 코드는 입력 `TokenStream`을 구성하고, 매크로가 생성하는 코드는 출력 `TokenStream`입니다. 또한 함수에는 생성하려는 절차적 매크로의 종류를 지정하는 속성이 첨부되어 있습니다. 동일한 크레이트에서 여러 종류의 절차적 매크로를 가질 수 있습니다.

다양한 종류의 절차적 매크로를 살펴보겠습니다. 사용자 정의 `derive` 매크로로 시작한 다음 다른 형식을 다르게 만드는 작은 차이점을 설명하겠습니다.
