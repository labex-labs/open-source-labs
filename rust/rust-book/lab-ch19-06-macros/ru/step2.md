# Разница между макросами и функциями

По своей本质，макросы - это способ написания кода, который генерирует другой код, что известно как _метапрограммирование_. В Приложении С мы обсуждаем атрибут `derive`, который генерирует реализацию различных трейтов для вас. Также мы использовали макросы `println!` и `vec!` на протяжении всей книги. Все эти макросы _расширяются_, чтобы сгенерировать больше кода, чем код, написанный вами вручную.

Метапрограммирование полезно для сокращения количества кода, который вы должны писать и поддерживать, что также является одной из ролей функций. Однако, макросы обладают некоторыми дополнительными возможностями, которых не обладают функции.

Подпись функции должна объявлять количество и тип параметров, которые имеет функция. В то же время макросы могут принимать переменное количество параметров: мы можем вызвать `println!("hello")` с одним аргументом или `println!("hello {}", name)` с двумя аргументами. Кроме того, макросы расширяются перед тем, как компилятор интерпретирует смысл кода, поэтому макрос, например, может реализовать трейт для заданного типа. Функция не может этого сделать, потому что она вызывается во время выполнения, а трейт должен быть реализован во время компиляции.

Недостатком реализации макроса вместо функции является то, что определение макроса более сложно, чем определение функции, потому что вы пишете Rust-код, который генерирует Rust-код. Вследствие этого косвенности определения макросов в целом более сложно читать, понимать и поддерживать, чем определения функций.

Еще одна важная разница между макросами и функциями заключается в том, что вы должны определить макросы или импортировать их в область видимости _до_ того, как вызвать их в файле, в отличие от функций, которые можно определить в любом месте и вызвать в любом месте.
