# Макросы, похожие на функции

Макросы, похожие на функции, определяют макросы, которые выглядят как вызовы функций. Подобно макросам `macro_rules!`, они более гибкие, чем функции; например, они могут принимать неизвестное количество аргументов. Однако, макросы `macro_rules!` могут быть определены только с использованием синтаксиса, похожего на `match`, который мы обсуждали в разделе "Декларативные макросы с macro_rules! для общего метапрограммирования". Макросы, похожие на функции, принимают параметр `TokenStream`, и их определение манипулирует этим `TokenStream` с использованием кода Rust, как это делают и другие два типа процедурных макросов. Примером макроса, похожего на функцию, является макрос `sql!`, который может вызываться так:

```rust
let sql = sql!(SELECT * FROM posts WHERE id=1);
```

Этот макрос разбирает SQL-запрос внутри себя и проверяет, является ли он синтаксически правильным, что гораздо более сложная обработка, чем может сделать макрос `macro_rules!`. Макрос `sql!` будет определен так:

```rust
#[proc_macro]
pub fn sql(input: TokenStream) -> TokenStream {
```

Это определение похоже на сигнатуру пользовательского макроса `derive`: мы получаем токены, находящиеся внутри скобок, и возвращаем код, который мы хотели сгенерировать.
