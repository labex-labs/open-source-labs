# Проверка количества потоков в new

Мы не делаем ничего с параметрами `new` и `execute`. Реализуем тела этих функций с нужным поведением. Сначала подумаем о `new`. Ранее мы выбрали незнаковый тип для параметра `size`, потому что пул с отрицательным количеством потоков не имеет смысла. Однако пул с нулевым количеством потоков также не имеет смысла, а ноль является абсолютно допустимым значением для `usize`. Мы добавим код для проверки того, что `size` больше нуля, прежде чем вернуть экземпляр `ThreadPool`, и заставим программу завершиться с ошибкой, если она получит ноль, используя макрос `assert!`, как показано в Listing 20-13.

Filename: `src/lib.rs`

```rust
impl ThreadPool {
    /// Создайте новый ThreadPool.
    ///
    /// Размер - это количество потоков в пуле.
    ///
  1 /// # Panics
    ///
    /// Функция `new` завершится с ошибкой, если размер равен нулю.
    pub fn new(size: usize) -> ThreadPool {
      2 assert!(size > 0);

        ThreadPool
    }

    --snip--
}
```

Listing 20-13: Реализация `ThreadPool::new` для завершения с ошибкой, если `size` равен нулю

Мы также добавили некоторую документацию для нашего `ThreadPool` с помощью doc-комментариев. Обратите внимание, что мы придерживались хороших практик по документированию, добавив раздел, в котором указаны ситуации, при которых наша функция может завершиться с ошибкой \[1\], как обсуждалось в главе 14. Попробуйте запустить `cargo doc --open` и нажать на структуру `ThreadPool`, чтобы увидеть, как выглядят сгенерированные документы для `new`!

Вместо добавления макроса `assert!`, как мы сделали здесь \[2\], мы могли бы изменить `new` на `build` и вернуть `Result`, как мы делали с `Config::build` в проекте по вводу-выводу в Listing 12-9. Но в этом случае мы решили, что попытка создать пул потоков без потоков должна быть неисправной ошибкой. Если вы чувствуете себя амбициозно, попробуйте написать функцию с именем `build` с такой сигнатурой, чтобы сравнить с функцией `new`:

```rust
pub fn build(
    size: usize
) -> Result<ThreadPool, PoolCreationError> {
```
