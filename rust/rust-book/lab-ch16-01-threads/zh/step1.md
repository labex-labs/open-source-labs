# 使用线程同时运行代码

在当前大多数操作系统中，一个已执行程序的代码是在一个**进程**中运行的，并且操作系统会同时管理多个进程。在一个程序内部，你也可以有同时运行的独立部分。运行这些独立部分的特性被称为**线程**。例如，一个 Web 服务器可以有多个线程，这样它就可以同时响应多个请求。

将程序中的计算分割成多个线程以同时运行多个任务可以提高性能，但这也增加了复杂性。因为线程可以同时运行，所以对于不同线程上的代码部分将以何种顺序运行并没有内在的保证。这可能会导致一些问题，比如：

- **竞态条件**，即线程以不一致的顺序访问数据或资源
- **死锁**，即两个线程相互等待，导致两个线程都无法继续执行
- 仅在某些特定情况下出现且难以可靠地重现和修复的错误

Rust 试图减轻使用线程带来的负面影响，但在多线程环境中进行编程仍然需要仔细考虑，并且需要一种与单线程运行的程序不同的代码结构。

编程语言以几种不同的方式实现线程，并且许多操作系统都提供了一种语言可以调用的 API 来创建新线程。Rust 标准库使用**1:1**的线程实现模型，即一个程序为每个语言线程使用一个操作系统线程。也有一些 crate 实现了其他线程模型，它们与 1:1 模型做出了不同的权衡。
