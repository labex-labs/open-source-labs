# 構造体の定義とインスタンス化

構造体は、「タプル型」で議論されているタプルと似ており、複数の関連する値を保持しています。タプルと同様に、構造体の要素は異なる型であることができます。タプルとは異なり、構造体では各データの要素に名前を付けるので、値が何を意味するのかが明確になります。これらの名前を追加することで、構造体はタプルよりも柔軟になります。インスタンスの値を指定またはアクセスする際に、データの順序に依存する必要はありません。

構造体を定義するには、キーワード`struct`を入力し、構造体全体に名前を付けます。構造体の名前は、まとめられているデータの要素の重要性を表すものでなければなりません。その後、波括弧の中で、データの要素の名前と型を定義します。これらを「フィールド」と呼びます。たとえば、リスト 5-1 は、ユーザーアカウントに関する情報を格納する構造体を示しています。

ファイル名：`src/main.rs`

```rust
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```

リスト 5-1: `User`構造体の定義

構造体を定義した後に使用するには、各フィールドに具体的な値を指定することで、その構造体の「インスタンス」を作成します。構造体の名前を記述し、その後にキー:値のペアを含む波括弧を追加することでインスタンスを作成します。ここで、キーはフィールドの名前で、値はそれらのフィールドに格納したいデータです。構造体で宣言した順序と同じ順序でフィールドを指定する必要はありません。言い換えると、構造体の定義は型の一般的なテンプレートのようなものであり、インスタンスはそのテンプレートに特定のデータを埋め込んで、その型の値を作成します。たとえば、リスト 5-2 に示すように、特定のユーザーを宣言することができます。

ファイル名：`src/main.rs`

```rust
fn main() {
    let user1 = User {
        active: true,
        username: String::from("someusername123"),
        email: String::from("someone@example.com"),
        sign_in_count: 1,
    };
}
```

リスト 5-2: `User`構造体のインスタンスの作成

構造体から特定の値を取得するには、ドット表記を使用します。たとえば、このユーザーのメールアドレスにアクセスするには、`user1.email`を使用します。インスタンスがミュータブルな場合、ドット表記を使用して特定のフィールドに代入することで値を変更することができます。リスト 5-3 は、ミュータブルな`User`インスタンスの`email`フィールドの値を変更する方法を示しています。

ファイル名：`src/main.rs`

```rust
fn main() {
    let mut user1 = User {
        active: true,
        username: String::from("someusername123"),
        email: String::from("someone@example.com"),
        sign_in_count: 1,
    };

    user1.email = String::from("anotheremail@example.com");
}
```

リスト 5-3: `User`インスタンスの`email`フィールドの値の変更

インスタンス全体がミュータブルであることに注意してください。Rust は、特定のフィールドのみをミュータブルとしてマークすることは許可していません。関数の最後の式として構造体の新しいインスタンスを構築することで、その新しいインスタンスを暗黙的に返すことができます。

リスト 5-4 は、与えられたメールアドレスとユーザー名を持つ`User`インスタンスを返す`build_user`関数を示しています。`active`フィールドは`true`の値を取得し、`sign_in_count`は`1`の値を取得します。

```rust
fn build_user(email: String, username: String) -> User {
    User {
        active: true,
        username: username,
        email: email,
        sign_in_count: 1,
    }
}
```

リスト 5-4: メールアドレスとユーザー名を受け取り、`User`インスタンスを返す`build_user`関数

関数のパラメータを構造体のフィールドと同じ名前で命名するのは理にかなっていますが、`email`と`username`のフィールド名と変数を繰り返すのは少々面倒です。構造体により多くのフィールドがある場合、各名前を繰り返すのはさらに面倒くさくなります。幸い、便利な省略記法があります！
