# 不健全な超能力

unsafe Rustに切り替えるには、`unsafe`キーワードを使用してから、unsafeコードを含む新しいブロックを開始します。unsafe Rustでは、safe Rustではできない5つの操作を行うことができます。これらを「不健全な超能力」と呼んでいます。これらの超能力には、以下の能力が含まれます。

1.  生のポインタを参照する
2.  不健全な関数またはメソッドを呼び出す
3.  可変な静的変数にアクセスまたは変更する
4.  不健全なトレイトを実装する
5.  `union`のフィールドにアクセスする

重要なことは、`unsafe`がバローチェッカーをオフにしたり、Rustの他のセーフティチェックのいずれかを無効にしたりしないことです。もしunsafeコードで参照を使う場合、それは依然としてチェックされます。`unsafe`キーワードは、コンパイラによるメモリセーフティのチェック対象外のこれら5つの機能にのみアクセスを与えます。unsafeブロック内ではある程度のセーフティが保たれます。

また、`unsafe`はブロック内のコードが必ずしも危険であることや、必ずしもメモリセーフティの問題があることを意味しません。プログラマとして、unsafeブロック内のコードがメモリにアクセスする方法が妥当であることを保証する必要があります。

人間は誤りやすく、ミスが起こります。しかし、これらの5つの不健全な操作を`unsafe`で注釈付けされたブロック内にすることで、メモリセーフティに関連するエラーは必ずunsafeブロック内にあることがわかります。unsafeブロックを小さく保ちましょう。後でメモリバグを調査するときに感謝するでしょう。

できる限り不健全なコードを分離するためには、そのようなコードを安全な抽象化の中に囲み、安全なAPIを提供することが望ましいです。これについては、後で不健全な関数とメソッドを調べるときに本章で議論します。標準ライブラリの一部は、監査された不健全なコードに対する安全な抽象化として実装されています。不健全なコードを安全な抽象化でラップすることで、`unsafe`の使用が、`unsafe`コードで実装された機能を使用したいあなた自身やユーザーのすべての場所に漏れ出すことを防ぎます。なぜなら、安全な抽象化を使うことは安全だからです。

では、5つの不健全な超能力を順に見ていきましょう。また、不健全なコードに対して安全なインターフェイスを提供するいくつかの抽象化についても見ていきます。
