# The match 제어 흐름 구문

Rust 는 `match`라는 매우 강력한 제어 흐름 구문을 가지고 있습니다. 이 구문을 사용하면 값을 일련의 패턴과 비교한 다음 일치하는 패턴에 따라 코드를 실행할 수 있습니다. 패턴은 리터럴 값, 변수 이름, 와일드카드 등 다양한 요소로 구성될 수 있습니다. 18 장에서는 다양한 종류의 패턴과 그 기능에 대해 다룹니다. `match`의 강력함은 패턴의 표현력과 컴파일러가 모든 가능한 경우를 처리하는지 확인한다는 사실에서 비롯됩니다.

`match` 표현식을 동전 분류 기계와 같다고 생각해보세요. 동전은 다양한 크기의 구멍이 있는 트랙을 따라 미끄러져 내려가고, 각 동전은 들어갈 수 있는 첫 번째 구멍으로 떨어집니다. 마찬가지로, 값은 `match`의 각 패턴을 거치며, 값과 "맞는" 첫 번째 패턴에서 값은 실행 중에 사용될 관련 코드 블록으로 떨어집니다.

동전 이야기를 해보죠. `match`를 사용하여 예를 들어보겠습니다! 알 수 없는 미국 동전을 받아 동전 분류 기계와 유사한 방식으로 어떤 동전인지 결정하고 센트 단위의 값을 반환하는 함수를 작성할 수 있습니다. 이는 Listing 6-3 에 나와 있습니다.

```rust
1 enum Coin {
    Penny,
    Nickel,
    Dime,
    Quarter,
}

fn value_in_cents(coin: Coin) -> u8 {
  2 match coin {
      3 Coin::Penny => 1,
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```

Listing 6-3: enum 과 enum 의 변형을 패턴으로 사용하는 `match` 표현식

`value_in_cents` 함수에서 `match`를 분석해 보겠습니다. 먼저 `match` 키워드와 그 뒤에 표현식을 나열합니다. 이 경우 값은 `coin` \[2]입니다. 이는 `if`와 함께 사용되는 표현식과 매우 유사하지만 큰 차이점이 있습니다. `if`의 경우 표현식은 부울 값을 반환해야 하지만 여기서는 모든 유형을 반환할 수 있습니다. 이 예에서 `coin`의 유형은 \[1]에서 정의한 `Coin` enum 입니다.

다음은 `match` arm 입니다. arm 은 패턴과 일부 코드로 구성됩니다. 여기 첫 번째 arm 은 `Coin::Penny` 값인 패턴과 패턴과 실행할 코드를 구분하는 `=>` 연산자 \[3]를 가지고 있습니다. 이 경우 코드는 값 `1`입니다. 각 arm 은 쉼표로 다음 arm 과 구분됩니다.

`match` 표현식이 실행되면 결과 값을 각 arm 의 패턴과 순서대로 비교합니다. 패턴이 값과 일치하면 해당 패턴과 관련된 코드가 실행됩니다. 해당 패턴이 값과 일치하지 않으면 실행은 다음 arm 으로 계속 진행됩니다. 이는 동전 분류 기계와 매우 유사합니다. 필요한 만큼 많은 arm 을 가질 수 있습니다. Listing 6-3 에서 `match`는 4 개의 arm 을 가지고 있습니다.

각 arm 과 관련된 코드는 표현식이며, 일치하는 arm 의 표현식의 결과 값은 전체 `match` 표현식에 대해 반환되는 값입니다.

Listing 6-3 과 같이 각 arm 이 값을 반환하는 경우처럼 match arm 코드가 짧으면 일반적으로 중괄호를 사용하지 않습니다. match arm 에서 여러 줄의 코드를 실행하려면 중괄호를 사용해야 하며, arm 뒤의 쉼표는 선택 사항입니다. 예를 들어, 다음 코드는 `Coin::Penny`로 메서드가 호출될 때마다 "Lucky penny!"를 출력하지만 블록의 마지막 값인 `1`을 반환합니다.

```rust
fn value_in_cents(coin: Coin) -> u8 {
    match coin {
        Coin::Penny => {
            println!("Lucky penny!");
            1
        }
        Coin::Nickel => 5,
        Coin::Dime => 10,
        Coin::Quarter => 25,
    }
}
```
