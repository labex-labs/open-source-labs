# スコープとプライバシーを制御するモジュールの定義

このセクションでは、モジュールとモジュールシステムの他の部分、つまりアイテムに名前を付けるための「パス」、スコープにパスを持ち込む`use`キーワード、およびアイテムを公開する`pub`キーワードについて説明します。また、`as`キーワード、外部パッケージ、およびグロブ演算子についても説明します。

**モジュール**は、読みやすさと再利用の容易さのために、クレート内のコードを整理することができます。モジュールはまた、アイテムの**プライバシー**を制御することもできます。なぜなら、モジュール内のコードはデフォルトで非公開になっているからです。非公開のアイテムは、外部で使用できない内部実装の詳細です。モジュールとその中のアイテムを公開するように選択することで、外部コードがそれらを使用して依存することができるようになります。

例として、レストランの機能を提供するライブラリクレートを書いてみましょう。関数のシグネチャを定義しますが、本体は空のままにして、コードの整理に集中するようにします。

レストラン業界では、レストランの一部は「フロント・オブ・ハウス」と呼ばれ、他の部分は「バック・オブ・ハウス」と呼ばれます。フロント・オブ・ハウスは、客がいる場所です。これには、ホストが客を席に案内する場所、サーバーが注文と支払いを受ける場所、バーテンダーがドリンクを作る場所が含まれます。バック・オブ・ハウスは、シェフや料理人がキッチンで働き、食器洗いが掃除をし、マネージャーが事務作業をする場所です。

このようにクレートを構造化するには、その機能をネストしたモジュールに整理することができます。`cargo new restaurant --lib`を実行して、新しいライブラリ`restaurant`を作成します。次に、リスト7-1のコードを`src/lib.rs`に入力して、いくつかのモジュールと関数のシグネチャを定義します。このコードは、フロント・オブ・ハウスのセクションです。

ファイル名：`src/lib.rs`

```rust
mod front_of_house {
    mod hosting {
        fn add_to_waitlist() {}

        fn seat_at_table() {}
    }

    mod serving {
        fn take_order() {}

        fn serve_order() {}

        fn take_payment() {}
    }
}
```

リスト7-1：他のモジュールを含む`front_of_house`モジュールで、それらのモジュールには関数が含まれる

`mod`キーワードの後にモジュールの名前（この場合は`front_of_house`）を続けることで、モジュールを定義します。その後、モジュールの本体は波括弧の中に入ります。モジュールの中では、他のモジュールを配置することができます。この場合、`hosting`と`serving`のモジュールがそれです。モジュールはまた、構造体、列挙体、定数、トレイト、および（リスト7-1のように）関数など、他のアイテムの定義も保持することができます。

モジュールを使用することで、関連する定義をまとめることができ、それらが関連する理由を名前付けすることができます。このコードを使用するプログラマは、グループに基づいてコードをナビゲートすることができ、すべての定義を読み通す必要がなくなり、自分に関連する定義を見つけるのが容易になります。このコードに新しい機能を追加するプログラマは、プログラムを整理し続けるために、コードを配置する場所を知っているでしょう。

先ほど、`src/main.rs`と`src/lib.rs`はクレートのルートと呼ばれることを述べました。その名前の由来は、これら2つのファイルのいずれかの内容が、クレートのモジュール構造のルートにある`crate`と呼ばれるモジュールを形成するからです。これは、**モジュールツリー**と呼ばれます。

リスト7-2は、リスト7-1の構造のモジュールツリーを示しています。

```bash
crate
└── front_of_house
├── hosting
│ ├── add_to_waitlist
│ └── seat_at_table
└── serving
├── take_order
├── serve_order
└── take_payment
```

リスト7-2：リスト7-1のコードのモジュールツリー

このツリーは、いくつかのモジュールが他のモジュールの中にどのようにネストしているかを示しています。たとえば、`hosting`は`front_of_house`の中にネストしています。また、このツリーは、いくつかのモジュールが**兄弟**であることも示しています。つまり、同じモジュール内で定義されているということです。`hosting`と`serving`は、`front_of_house`内で定義された兄弟です。モジュールAがモジュールBの中に含まれている場合、モジュールAはモジュールBの**子**であり、モジュールBはモジュールAの**親**であると言います。すべてのモジュールツリーは、暗黙のモジュール`crate`の下に根付いていることに注意してください。

モジュールツリーは、コンピュータのファイルシステムのディレクトリツリーを思い出させるかもしれません。これは非常に適切な比較です！ファイルシステムのディレクトリと同じように、モジュールを使ってコードを整理します。また、ディレクトリ内のファイルと同じように、モジュールを見つける方法が必要です。
