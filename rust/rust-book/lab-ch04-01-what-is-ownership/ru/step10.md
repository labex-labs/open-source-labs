# Возвращаемые значения и область видимости

Возвращение значений также может передавать владение. В листинге 4-4 показан пример функции, которая возвращает какое-то значение, с аналогичными аннотациями, как в листинге 4-3.

    // src/main.rs
    fn main() {
        let s1 = gives_ownership();         // gives_ownership перемещает свое возвращаемое
                                            // значение в s1

        let s2 = String::from("hello");     // s2 входит в область видимости

        let s3 = takes_and_gives_back(s2);  // s2 перемещается в
                                            // takes_and_gives_back, которая также
                                            // перемещает свое возвращаемое значение в s3
    } // Здесь s3 выходит из области видимости и уничтожается. s2 была перемещена, поэтому
      // ничего не происходит. s1 выходит из области видимости и уничтожается

    fn gives_ownership() -> String {             // gives_ownership будет перемещать свое
                                                 // возвращаемое значение в функцию,
                                                 // которая ее вызывает

        let some_string = String::from("yours"); // some_string входит в область видимости

        some_string                              // some_string возвращается и
                                                 // перемещается в вызывающую
                                                 // функцию
    }

    // Эта функция принимает String и возвращает String
    fn takes_and_gives_back(a_string: String) -> String { // a_string входит в
                                                          // область видимости

        a_string  // a_string возвращается и перемещается в вызывающую функцию
    }

Листинг 4-4: Передача владения возвращаемым значениям

Владение переменной всегда遵循相同的模式：将值赋给另一个变量会移动它。当包含堆上数据的变量超出作用域时，除非数据的所有权已转移到另一个变量，否则该值将由`drop`清理。

虽然这样可行，但每个函数都获取所有权然后再返回所有权有点繁琐。如果我们想让一个函数使用一个值但不获取所有权怎么办？如果我们想再次使用传入的任何东西，除了函数体可能产生的任何我们可能想要返回的数据之外，还需要将其传递回去，这非常麻烦。

Rust 确实允许我们使用元组返回多个值，如清单 4-5 所示。

文件名：`src/main.rs`

```rust
fn main() {
    let s1 = String::from("hello");

    let (s2, len) = calculate_length(s1);

    println!("The length of '{s2}' is {len}.");
}

fn calculate_length(s: String) -> (String, usize) {
    let length = s.len(); // len() возвращает длину String

    (s, length)
}
```

Листинг 4-5: Возвращение владения параметрам

Но это слишком много хлопот и работы для концепции, которая должна быть распространенной. К счастью для нас, у Rust есть функция для использования значения без передачи владения, называемая _ссылками_.
