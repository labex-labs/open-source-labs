# 병렬 또는 순차적으로 테스트 실행

여러 테스트를 실행할 때, 기본적으로 스레드를 사용하여 병렬로 실행되므로 더 빠르게 완료되고 더 빠르게 피드백을 받습니다. 테스트가 동시에 실행되므로, 테스트가 서로 또는 현재 작업 디렉토리나 환경 변수와 같은 공유 환경을 포함한 공유 상태에 의존하지 않도록 해야 합니다.

예를 들어, 각 테스트가 *test-output.txt*라는 이름의 디스크에 파일을 생성하고 해당 파일에 일부 데이터를 쓰는 코드를 실행한다고 가정해 보겠습니다. 그런 다음 각 테스트는 해당 파일의 데이터를 읽고 파일에 특정 값이 포함되어 있는지 확인하며, 각 테스트마다 값이 다릅니다. 테스트가 동시에 실행되므로, 한 테스트가 다른 테스트가 파일을 쓰고 읽는 시간 사이에 파일을 덮어쓸 수 있습니다. 그러면 두 번째 테스트가 실패하게 되는데, 이는 코드가 잘못되었기 때문이 아니라 테스트가 병렬로 실행되는 동안 서로 간섭했기 때문입니다. 한 가지 해결책은 각 테스트가 다른 파일에 쓰도록 하는 것이고, 다른 해결책은 테스트를 한 번에 하나씩 실행하는 것입니다.

테스트를 병렬로 실행하고 싶지 않거나 사용되는 스레드 수에 대해 더 세밀한 제어를 원한다면, `--test-threads` 플래그와 사용하려는 스레드 수를 테스트 바이너리로 보낼 수 있습니다. 다음 예제를 살펴보세요.

```bash
cargo test -- --test-threads=1
```

테스트 스레드 수를 `1`로 설정하여 프로그램이 병렬 처리를 사용하지 않도록 했습니다. 하나의 스레드를 사용하여 테스트를 실행하는 것은 병렬로 실행하는 것보다 시간이 더 오래 걸리지만, 테스트가 상태를 공유하는 경우 서로 간섭하지 않습니다.
