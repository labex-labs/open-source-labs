# Использование возвращаемого итератора напрямую

Откройте файл `src/main.rs` вашего проекта по вводу-выводу, который должен выглядеть так:

Имя файла: `src/main.rs`

```rust
fn main() {
    let args: Vec<String> = env::args().collect();

    let config = Config::build(&args).unwrap_or_else(|err| {
        eprintln!("Problem parsing arguments: {err}");
        process::exit(1);
    });

    --snip--
}
```

Сначала мы изменим начало функции `main`, которое мы имели в листинге 12-24, на код из листинга 13-18, который на этот раз использует итератор. Это не скомпилируется, пока мы не обновим `Config::build` также.

Имя файла: `src/main.rs`

```rust
fn main() {
    let config =
        Config::build(env::args()).unwrap_or_else(|err| {
            eprintln!("Problem parsing arguments: {err}");
            process::exit(1);
        });

    --snip--
}
```

Листинг 13-18: Передача возвращаемого значения `env::args` в `Config::build`

Функция `env::args` возвращает итератор! Вместо сбора значений итератора в вектор и последующей передачи среза в `Config::build`, теперь мы напрямую передаём владение итератором, возвращаемым из `env::args`, в `Config::build`.

Далее, нам нужно обновить определение `Config::build`. В файле `src/lib.rs` вашего проекта по вводу-выводу давайте изменим сигнатуру `Config::build` так, чтобы она выглядела как в листинге 13-19. Это по-прежнему не скомпилируется, потому что нам нужно обновить тело функции.

Имя файла: `src/lib.rs`

```rust
impl Config {
    pub fn build(
        mut args: impl Iterator<Item = String>,
    ) -> Result<Config, &'static str> {
        --snip--
```

Листинг 13-19: Обновление сигнатуры `Config::build` для ожидания итератора

Документация по стандартной библиотеке для функции `env::args` показывает, что тип итератора, который она возвращает, это `std::env::Args`, и этот тип реализует трейт `Iterator` и возвращает значения типа `String`.

Мы обновили сигнатуру функции `Config::build`, так что параметр `args` имеет обобщённый тип с ограничениями трейтов `impl Iterator<Item = String>` вместо `&[String]`. Это использование синтаксиса `impl Trait`, о котором мы говорили в разделе "Трейты в качестве параметров", означает, что `args` может быть любым типом, который реализует тип `Iterator` и возвращает элементы типа `String`.

Поскольку мы берём владение `args` и будем изменять `args`, итерируясь по нему, мы можем добавить ключевое слово `mut` в спецификацию параметра `args`, чтобы сделать его изменяемым.
