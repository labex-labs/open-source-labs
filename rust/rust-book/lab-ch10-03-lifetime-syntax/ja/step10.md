# メソッド定義における寿命注釈

寿命を持つ構造体にメソッドを実装する場合、リスト10-11に示すジェネリック型パラメータと同じ構文を使用します。寿命パラメータを宣言して使用する場所は、それらが構造体フィールド、またはメソッドパラメータと返り値に関係するかどうかに依存します。

構造体フィールドの寿命名は常に、`impl`キーワードの後に宣言し、その後、構造体名の後で使用する必要があります。なぜなら、それらの寿命は構造体の型の一部だからです。

`impl`ブロック内のメソッドシグネチャでは、参照は構造体フィールド内の参照の寿命に関連付けられる場合もあれば、独立している場合もあります。また、寿命省略規則により、メソッドシグネチャに寿命注釈が必要ない場合が多いです。リスト10-24で定義した`ImportantExcerpt`という名前の構造体を使ったいくつかの例を見てみましょう。

まず、`level`という名前のメソッドを使います。このメソッドの唯一のパラメータは`self`への参照で、返り値は`i32`で、何かへの参照ではありません。

```rust
impl<'a> ImportantExcerpt<'a> {
    fn level(&self) -> i32 {
        3
    }
}
```

`impl`の後の寿命パラメータ宣言と、型名の後でのその使用は必要ですが、最初の省略規則のため、`self`への参照の寿命を注釈する必要はありません。

ここに、3番目の寿命省略規則が適用される例があります。

```rust
impl<'a> ImportantExcerpt<'a> {
    fn announce_and_return_part(&self, announcement: &str) -> &str {
        println!("Attention please: {announcement}");
        self.part
    }
}
```

入力寿命が2つあるため、Rustは最初の寿命省略規則を適用し、`&self`と`announcement`の両方に独自の寿命を与えます。その後、パラメータの1つが`&self`であるため、返り値の型に`&self`の寿命が与えられ、すべての寿命が考慮されます。
