# Использование пакета для получения дополнительной функциональности

Помните, что пакет (crate) - это коллекция файлов с исходным кодом на Rust. Проект, который мы一直在构建，является _бинарным пакетом_, то есть исполняемым файлом. Пакет `rand` - это _библиотечный пакет_, который содержит код, предназначенный для использования в других программах и не может быть запущен самостоятельно.

Взаимодействие Cargo с внешними пакетами - это то, где Cargo действительно превосходит. Перед тем, как мы сможем написать код, использующий `rand`, нам нужно изменить файл `Cargo.toml`, чтобы включить пакет `rand` в качестве зависимости. Теперь откройте этот файл и добавьте следующую строку в конец, под заголовком `[dependencies]`, который Cargo создал для вас. Убедитесь, что указать `rand` именно так, как здесь, с этой версией номера, иначе примеры кода в этом руководстве могут не работать:

Имя файла: `Cargo.toml`

```tomlrust
[dependencies]
rand = "0.8.5"
```

В файле `Cargo.toml` все, что следует после заголовка, является частью этого раздела, который продолжается до начала следующего раздела. В разделе `[dependencies]` вы говорите Cargo, какие внешние пакеты зависит ваш проект и какие версии этих пакетов вы требуете. В этом случае мы указываем пакет `rand` с семантическим спецификатором версии `0.8.5`. Cargo понимает Семантическое Версионирование (иногда называемое _SemVer_), которое является стандартом для записи номеров версий. Спецификатор `0.8.5` на самом деле сокращение для `^0.8.5`, что означает любую версию, которая не менее 0.8.5, но ниже 0.9.0.

Cargo считает, что эти версии имеют совместимые с версией 0.8.5 публичные API, и это спецификация гарантирует, что вы получите последний патч-релиз, который по-прежнему будет компилироваться с кодом в этой главе. Любая версия 0.9.0 или выше не гарантируется, что имеет такой же API, как в следующих примерах.

Теперь, не меняя никакого кода, давайте построим проект, как показано в Листинге 2-2.

```bash
$ cargo build
    Updating crates.io index
  Downloaded rand v0.8.5
  Downloaded libc v0.2.127
  Downloaded getrandom v0.2.7
  Downloaded cfg-if v1.0.0
  Downloaded ppv-lite86 v0.2.16
  Downloaded rand_chacha v0.3.1
  Downloaded rand_core v0.6.3
   Compiling rand_core v0.6.3
   Compiling libc v0.2.127
   Compiling getrandom v0.2.7
   Compiling cfg-if v1.0.0
   Compiling ppv-lite86 v0.2.16
   Compiling rand_chacha v0.3.1
   Compiling rand v0.8.5
   Compiling guessing_game v0.1.0 (file:///projects/guessing_game)
    Finished dev [unoptimized + debuginfo] target(s) in 2.53s
```

Листинг 2-2: Вывод после запуска `cargo build` после добавления пакета `rand` в качестве зависимости

Вы можете увидеть разные номера версий (но они все будут совместимы с кодом, благодаря SemVer!) и разные строки (зависит от операционной системы), и строки могут быть в другом порядке.

Когда мы включаем внешнюю зависимость, Cargo получает последние версии всех зависимостей из _реестра_, который является копией данных с Crates.io по адресу *https://crates.io*. Crates.io - это место, где люди в Rust-экосистеме публикуют свои открытые исходные проекты на Rust для использования другими.

После обновления реестра Cargo проверяет раздел `[dependencies]` и загружает любые пакеты, перечисленные там, которые еще не были загружены. В этом случае, хотя мы только указали `rand` в качестве зависимости, Cargo также загрузил другие пакеты, от которых зависит `rand` для работы. После загрузки пакетов Rust компилирует их и затем компилирует проект с доступными зависимостями.

Если вы сразу же снова запустите `cargo build` без внесения изменений, вы не получите никакого вывода, кроме строки `Finished`. Cargo знает, что уже загрузил и скомпилировал зависимости, и вы ничего не изменили в файле `Cargo.toml` по отношению к ним. Cargo также знает, что вы ничего не изменили в своем коде, поэтому он не компилирует его снова. Нет ничего для выполнения, поэтому он просто завершает работу.

Если вы откроете файл `src/main.rs`, внесете тривиальное изменение, сохраните его и снова запустите сборку, вы увидите только две строки вывода:

```bash
$ cargo build
   Compiling guessing_game v0.1.0 (file:///projects/guessing_game)
    Finished dev [unoptimized + debuginfo] target(s) in 2.53 secs
```

Эти строки показывают, что Cargo обновляет сборку только с вашим малым изменением в файле `src/main.rs`. Ваши зависимости не изменились, поэтому Cargo знает, что может использовать то, что уже загрузил и скомпилировал для них.
