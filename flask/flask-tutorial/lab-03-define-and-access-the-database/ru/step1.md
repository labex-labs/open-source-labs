# Настройка базы данных

Во - первых, нам нужно настроить базу данных SQLite для хранения пользователей и постов. SQLite - это удобный выбор, так как он не требует отдельного сервера базы данных и встроен в Python.

В нашем приложении Flask мы создадим соединение с базой данных SQLite. Это соединение обычно связано с запросом в веб - приложениях и закрывается после завершения работы.

Соединение устанавливается с использованием функции `sqlite3.connect`, и мы используем специальный объект Flask `g` для хранения и повторного использования соединения.

Создайте новый файл Python `db.py` и добавьте следующий код:

```python
# flaskr/db.py

import sqlite3
from flask import current_app, g

def get_db():
    # Проверьте, есть ли 'db' в 'g'
    if 'db' not in g:
        # Установите соединение с базой данных
        g.db = sqlite3.connect(
            current_app.config['DATABASE'],
            detect_types=sqlite3.PARSE_DECLTYPES
        )
        # Возвращайте строки, которые ведут себя как словари
        g.db.row_factory = sqlite3.Row

    return g.db

def close_db(e=None):
    # Удалите 'db' из 'g' и закройте соединение, если оно существует
    db = g.pop('db', None)

    if db is not None:
        db.close()
```
