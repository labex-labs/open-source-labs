# Обработка крайних случаев

Наша функция работает хорошо для простых объектов, но что насчет более сложных случаев? Давайте рассмотрим некоторые крайние случаи и посмотрим, как наша функция их обрабатывает.

## Пустые объекты

Сначала протестируем с пустым объектом:

```javascript
lowerizeKeys({});
```

Вывод должен быть пустым объектом:

```
{}
```

## Объекты с вложенными объектами

Что, если объект содержит вложенные объекты? Давайте попробуем:

```javascript
const nestedObject = {
  User: {
    Name: "John",
    Contact: {
      EMAIL: "john@example.com",
      PHONE: "123-456-7890"
    }
  }
};

lowerizeKeys(nestedObject);
```

Вывод будет таким:

```
{ user: { Name: 'John', Contact: { EMAIL: 'john@example.com', PHONE: '123-456-7890' } } }
```

Обратите внимание, что только ключ верхнего уровня `User` преобразован в нижний регистр. Ключи внутри вложенных объектов остались без изменений.

Для обработки вложенных объектов нам нужно модифицировать нашу функцию, чтобы она рекурсивно обрабатывала все объекты. Давайте создадим улучшенную версию:

```javascript
const deepLowerizeKeys = (obj) => {
  return Object.keys(obj).reduce((acc, key) => {
    const value = obj[key];
    // Check if the value is an object and not null
    const newValue =
      value && typeof value === "object" && !Array.isArray(value)
        ? deepLowerizeKeys(value)
        : value;

    acc[key.toLowerCase()] = newValue;
    return acc;
  }, {});
};
```

Эта улучшенная функция:

1. Проверяет, является ли каждое значение также объектом (и не массивом или `null`).
2. Если это так, она рекурсивно вызывает саму себя для этого вложенного объекта.
3. В противном случае она использует исходное значение.

Давайте протестируем ее с нашим вложенным объектом:

```javascript
const deepLowerizedObject = deepLowerizeKeys(nestedObject);
deepLowerizedObject;
```

Теперь вы должны увидеть, что все ключи преобразованы в нижний регистр, даже в вложенных объектах:

```
{ user: { name: 'John', contact: { email: 'john@example.com', phone: '123-456-7890' } } }
```

Отличная работа! Вы создали продвинутую функцию, которая может обрабатывать вложенные объекты.
