# 애니메이션 완료 후 작업 수행

jQuery 효과를 구현할 때 흔히 저지르는 실수는 체인에서 다음 메서드의 실행이 애니메이션이 완료될 때까지 기다릴 것이라고 가정하는 것입니다.

```js
$("div.hidden").fadeIn(1500).addClass("lookAtMe");
```

위의 `.fadeIn()`은 단지 애니메이션을 시작할 뿐이라는 것을 깨닫는 것이 중요합니다. 일단 시작되면, 애니메이션은 JavaScript `setInterval()` 루프에서 CSS 속성을 빠르게 변경하여 구현됩니다. `.fadeIn()`을 호출하면 애니메이션 루프가 시작되고 jQuery 객체를 반환하여 `.addClass()`로 전달됩니다. 그러면 애니메이션 루프가 시작되는 동안 `lookAtMe` 스타일 클래스가 추가됩니다.

애니메이션이 완료된 후에 작업을 연기하려면 애니메이션 콜백 함수를 사용해야 합니다. 위에서 논의한 모든 애니메이션 메서드에 전달되는 두 번째 인수로 애니메이션 콜백을 지정할 수 있습니다. 위의 코드 조각의 경우, 다음과 같이 콜백을 구현할 수 있습니다.

```js
// 모든 숨겨진 단락을 페이드 인합니다. 그런 다음 스타일 클래스를 추가합니다 (애니메이션 콜백으로 수정).
$("div.hidden").fadeIn(1500, function () {
  // this = 방금 애니메이션이 완료된 DOM 요소
  $(this).addClass("lookAtMe");
});
```

`this` 키워드를 사용하여 애니메이션 중인 DOM 요소를 참조할 수 있습니다. 또한 콜백은 jQuery 객체의 각 요소에 대해 호출됩니다. 즉, 선택자가 요소를 반환하지 않으면 애니메이션 콜백이 실행되지 않습니다! 선택이 요소를 반환했는지 테스트하여 이 문제를 해결할 수 있습니다. 그렇지 않은 경우 콜백을 즉시 실행할 수 있습니다.

```js
// 애니메이션할 요소가 없더라도 콜백을 실행합니다.
var someElement = $("#nonexistent");

var cb = function () {
  console.log("done!");
};

if (someElement.length) {
  someElement.fadeIn(300, cb);
} else {
  cb();
}
```

> **Web 8080** 탭을 새로 고쳐 웹 페이지를 미리 볼 수 있습니다.
