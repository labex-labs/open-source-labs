# Настройка списка объектов для изменения в административном интерфейсе

Теперь, когда страница администратора для вопросов выглядит хорошо, давайте внесём некоторые правки на страницу "списка объектов для изменения" — ту, которая отображает все вопросы в системе.

Вот, как она выглядит на данный момент:

![Страница списка объектов для изменения в приложении Polls](../assets/admin04t.png)

По умолчанию Django отображает `str()` каждого объекта. Но иногда бывает полезнее отобразить отдельные поля. Для этого используйте параметр `~django.contrib.admin.ModelAdmin.list_display` административного интерфейса, который представляет собой кортеж имен полей, которые будут отображаться в виде столбцов на странице списка объектов для изменения для данного объекта:

```python
class QuestionAdmin(admin.ModelAdmin):
    #...
    list_display = ["question_text", "pub_date"]
```

Для дополнительного улучшения давайте также добавим метод `was_published_recently()` из раздела **Настройка базы данных**:

```python
class QuestionAdmin(admin.ModelAdmin):
    #...
    list_display = ["question_text", "pub_date", "was_published_recently"]
```

Теперь страница списка вопросов для изменения выглядит так:

![Представление списка вопросов для изменения](../assets/20230908-16-14-08-GNY2lggF.png)

Вы можете нажать на заголовки столбцов, чтобы отсортировать по этим значениям — за исключением заголовка `was_published_recently`, потому что сортировка по результату работы произвольного метода не поддерживается. Также обратите внимание, что по умолчанию заголовок столбца для `was_published_recently` — это имя метода (с подчёркиваниями заменёнными на пробелы), и на каждой строке содержится строковое представление результата.

Вы можете улучшить это, используя декоратор `~django.contrib.admin.display` для этого метода (в `polls/models.py`), следующим образом:

```python
from django.contrib import admin


class Question(models.Model):
    #...
    @admin.display(
        boolean=True,
        ordering="pub_date",
        description="Published recently?",
    )
    def was_published_recently(self):
        now = timezone.now()
        return now - datetime.timedelta(days=1) <= self.pub_date <= now
```

Для получения дополнительной информации о настройках, доступных через декоратор, см. `~django.contrib.admin.ModelAdmin.list_display`.

Откройте снова файл `polls/admin.py` и добавьте улучшение на страницу списка вопросов для изменения: фильтры, используя `~django.contrib.admin.ModelAdmin.list_filter`. Добавьте следующую строку в `QuestionAdmin`:

```python
list_filter = ["pub_date"]
```

Это добавит боковую панель "Фильтр", которая позволяет пользователям фильтровать список объектов для изменения по полю `pub_date`:

![Боковая панель фильтра в административном интерфейсе](../assets/20230908-16-16-39-otfMNyYo.png)

Тип фильтра, отображаемого, зависит от типа поля, по которому вы фильтруете. Поскольку `pub_date` является `~django.db.models.DateTimeField`, Django знает, что нужно предоставить соответствующие варианты фильтрации: "Любая дата", "Сегодня", "Последние 7 дней", "Этот месяц", "Этот год".

Все это выглядит хорошо. Добавим поиск:

```python
search_fields = ["question_text"]
```

Это добавит поле поиска в верхней части списка объектов для изменения. Когда пользователь вводит поисковые запросы, Django будет искать по полю `question_text`. Вы можете использовать столько полей, сколько хотите — хотя, поскольку幕后使用 `LIKE` запрос, ограничение количества полей поиска до разумного числа упростит поиск в базе данных.

Теперь также стоит отметить, что списки объектов для изменения предоставляют автоматическую постраничность. По умолчанию на каждой странице отображается 100 элементов. `Постраничность списка объектов для изменения <django.contrib.admin.ModelAdmin.list_per_page>`, `поля поиска <django.contrib.admin.ModelAdmin.search_fields>`, `фильтры <django.contrib.admin.ModelAdmin.list_filter>`, `иерархия дат <django.contrib.admin.ModelAdmin.date_hierarchy>` и `упорядочивание заголовков столбцов <django.contrib.admin.ModelAdmin.list_display>` все работают так, как вы ожидаете.
