# Загрузка данных и подгонка модели

Начнем с загрузки набора данных Olivetti Faces и ограничения набора данных так, чтобы он содержал только первые пять классов. Затем обучим случайный лес на наборе данных и оценим важность признаков на основе нечистоты. Зададим количество ядер, которые будут использоваться для задач.

```python
from sklearn.datasets import fetch_olivetti_faces

# Мы выбираем количество ядер, которые будут использоваться для параллельной подгонки
# модели леса. `-1` означает использовать все доступные ядра.
n_jobs = -1

# Загружаем набор данных лиц
data = fetch_olivetti_faces()
X, y = data.data, data.target

# Ограничиваем набор данных 5 классами.
mask = y < 5
X = X[mask]
y = y[mask]

# Случайный лес классификатор будет подогнан, чтобы вычислить важность признаков.
from sklearn.ensemble import RandomForestClassifier

forest = RandomForestClassifier(n_estimators=750, n_jobs=n_jobs, random_state=42)

forest.fit(X, y)
```
