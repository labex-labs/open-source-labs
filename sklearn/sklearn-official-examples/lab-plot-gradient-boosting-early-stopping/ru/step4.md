# Построение и обучение модели с ранним прекращением

Теперь мы построим и обучим модель градиентного бустинга с ранним прекращением. Мы задаем параметр _validation_fraction_, который обозначает долю целого датасета, которая будет отделена от обучения для оценки потери модели на валидации. Модель градиентного бустинга обучается на тренировочном наборе и оценивается на валидационном наборе. Когда добавляется каждый дополнительный этап построения регрессионного дерева, валидационный набор используется для оценки модели. Это продолжается до тех пор, пока показатели модели на последних _n_iter_no_change_ этапах не улучшатся на величину не менее _tol_. После этого модель считается сконвергированной и дальнейшее добавление этапов "прекращается заранее". Количество этапов финальной модели доступно по атрибуту _n_estimators_.

```python
gbes = ensemble.GradientBoostingClassifier(
        n_estimators=n_estimators,
        validation_fraction=0.2,
        n_iter_no_change=5,
        tol=0.01,
        random_state=0,
    )
start = time.time()
gbes.fit(X_train, y_train)
time_gbes.append(time.time() - start)
```
