# Создание и настройка графика с разрывной осью

На этом этапе мы создадим саму структуру графика с разрывной осью. График с разрывной осью состоит из нескольких подграфиков, которые показывают разные диапазоны одних и тех же данных. Мы настроим эти подграфики для эффективного отображения как основного набора данных, так и выбросов.

## Создание подграфиков

Сначала нам нужно создать два подграфика, расположенных вертикально. Верхний подграфик будет отображать наши выбросы, а нижний - большинство точек данных.

Создайте новую ячейку в своем блокноте и добавьте следующий код:

```python
# Создание двух подграфиков, расположенных вертикально с общей осью x
fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True, figsize=(8, 6))

# Добавление общего заголовка к фигуре
fig.suptitle('Broken Axis Plot Example', fontsize=16)

# Построение одних и тех же данных на обеих осях
ax1.plot(pts, 'o-', color='blue')
ax2.plot(pts, 'o-', color='blue')

# Отображение фигуры с обоими подграфиками
plt.tight_layout()
plt.show()
```

![broken-axis-plot](../assets/screenshot-20250306-cawcMZv3@2x.png)

При запуске этой ячейки вы должны увидеть фигуру с двумя подграфиками, оба показывающими одни и те же данные. Обратите внимание, как выбросы сжимают остальные данные на обоих графиках, затрудняя просмотр деталей большинства точек данных. Именно эту проблему мы пытаемся решить с помощью графика с разрывной осью.

## Настройка пределов оси Y

Теперь нам нужно настроить каждый подграфик так, чтобы он был сосредоточен на определенном диапазоне значений оси Y. Верхний подграфик будет сосредоточен на диапазоне выбросов, а нижний - на основном диапазоне данных.

Создайте новую ячейку и добавьте следующий код:

```python
# Создание двух подграфиков, расположенных вертикально с общей осью x
fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True, figsize=(8, 6))

# Построение одних и тех же данных на обеих осях
ax1.plot(pts, 'o-', color='blue')
ax2.plot(pts, 'o-', color='blue')

# Установка пределов оси Y для каждого подграфика
ax1.set_ylim(0.78, 1.0)    # Верхний подграфик показывает только выбросы
ax2.set_ylim(0, 0.22)      # Нижний подграфик показывает только основные данные

# Добавление заголовка к каждому подграфику
ax1.set_title('Outlier Region')
ax2.set_title('Main Data Region')

# Отображение фигуры с настроенными пределами оси Y
plt.tight_layout()
plt.show()
```

При запуске этой ячейки вы должны увидеть, что каждый подграфик теперь сосредоточен на разном диапазоне значений оси Y. Верхний график показывает только выбросы, а нижний - только основные данные. Это уже улучшает визуализацию, но чтобы сделать его правильным графиком с разрывной осью, нам нужно добавить несколько дополнительных настроек.

## Скрытие осей и настройка делений

Чтобы создать иллюзию "разрывной" оси, нам нужно скрыть соединяющие оси между двумя подграфиками и настроить положение делений.

Создайте новую ячейку и добавьте следующий код:

```python
# Создание двух подграфиков, расположенных вертикально с общей осью x
fig, (ax1, ax2) = plt.subplots(2, 1, sharex=True, figsize=(8, 6))

# Построение одних и тех же данных на обеих осях
ax1.plot(pts, 'o-', color='blue')
ax2.plot(pts, 'o-', color='blue')

# Установка пределов оси Y для каждого подграфика
ax1.set_ylim(0.78, 1.0)    # Верхний подграфик показывает только выбросы
ax2.set_ylim(0, 0.22)      # Нижний подграфик показывает только основные данные

# Скрытие осей между ax1 и ax2
ax1.spines.bottom.set_visible(False)
ax2.spines.top.set_visible(False)

# Настройка положения делений
ax1.xaxis.tick_top()          # Перемещение делений оси x вверх
ax1.tick_params(labeltop=False)  # Скрытие подписей делений оси x сверху
ax2.xaxis.tick_bottom()       # Оставление делений оси x снизу

# Добавление подписей к графику
ax2.set_xlabel('Data Point Index')
ax2.set_ylabel('Value')
ax1.set_ylabel('Value')

plt.tight_layout()
plt.show()
```

При запуске этой ячейки вы должны увидеть, что на графике теперь скрыты оси между двумя подграфиками, что создает более чистый вид. Деления оси x теперь расположены правильно, с подписями только снизу.

На данном этапе мы успешно создали базовый график с разрывной осью. На следующем этапе мы добавим финальные штрихи, чтобы зрителям было ясно, что ось разорвана.
