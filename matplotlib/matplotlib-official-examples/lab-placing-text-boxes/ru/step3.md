# Добавление текстового блока со статистикой

Теперь, когда у нас есть простая гистограмма, усовершенствуем ее, добавив текстовый блок, отображающий статистическую информацию о наших данных. Это сделает визуализацию более информативной для зрителей.

## Создание текстового содержимого

Сначала нам нужно подготовить текстовое содержимое, которое будет находиться внутри нашего текстового блока. В новой ячейке введите и запустите следующий код:

```python
# Create a string with the statistics
textstr = '\n'.join((
    r'$\mu=%.2f$' % (mu,),           # Mean
    r'$\mathrm{median}=%.2f$' % (median,),  # Median
    r'$\sigma=%.2f$' % (sigma,)       # Standard deviation
))

print("Text content for our box:")
print(textstr)
```

Вы должны увидеть вывод, похожий на следующий:

```
Text content for our box:
$\mu=-0.31$
$\mathrm{median}=-0.28$
$\sigma=29.86$
```

Этот код создает многострочную строку, содержащую среднее значение, медиану и стандартное отклонение наших данных. Рассмотрим некоторые интересные аспекты этого кода:

1. Метод `\n'.join(...)` объединяет несколько строк, вставляя между ними символ новой строки.
2. Символ `r` перед каждой строкой делает ее "сырой" строкой, что полезно при использовании специальных символов.
3. Запись `$...$` используется для математического форматирования в стиле LaTeX в matplotlib.
4. `\mu` и `\sigma` - это символы LaTeX для греческих букв μ (му) и σ (сигма).
5. `%.2f` - это спецификатор формата, который отображает число с плавающей точкой с двумя знаками после запятой.

## Создание и добавление текстового блока

Теперь пересоздадим нашу гистограмму и добавим к ней текстовый блок. В новой ячейке введите и запустите следующий код:

```python
# Create a new figure and axes
fig, ax = plt.subplots(figsize=(10, 6))

# Create a histogram with 50 bins
histogram = ax.hist(x, bins=50, color='skyblue', edgecolor='black')

# Add title and labels
ax.set_title('Distribution of Random Data with Statistics', fontsize=16)
ax.set_xlabel('Value', fontsize=12)
ax.set_ylabel('Frequency', fontsize=12)

# Define the properties of the text box
properties = dict(boxstyle='round', facecolor='wheat', alpha=0.5)

# Add the text box to the plot
# Position the box in the top left corner (0.05, 0.95) in axes coordinates
ax.text(0.05, 0.95, textstr, transform=ax.transAxes, fontsize=14,
        verticalalignment='top', bbox=properties)

# Display the plot
plt.tight_layout()
plt.show()
```

При запуске этой ячейки вы должны увидеть свою гистограмму с текстовым блоком в левом верхнем углу, отображающим статистику.

## Понимание кода для текстового блока

Разберем важные части кода, создающего текстовый блок:

1. `properties = dict(boxstyle='round', facecolor='wheat', alpha=0.5)`:

   - Это создает словарь с свойствами текстового блока.
   - `boxstyle='round'`: Делает углы блока закругленными.
   - `facecolor='wheat'`: Устанавливает цвет фона блока в цвет пшеницы.
   - `alpha=0.5`: Делает блок полупрозрачным (50% непрозрачности).

2. `ax.text(0.05, 0.95, textstr, transform=ax.transAxes, fontsize=14, verticalalignment='top', bbox=properties)`:
   - Это добавляет текст на оси в позиции (0.05, 0.95).
   - `transform=ax.transAxes`: Это очень важно - это означает, что координаты заданы в единицах осей (от 0 до 1), а не в единицах данных. Таким образом, (0.05, 0.95) означает "на 5% от левого края и на 95% от нижнего края графика".
   - `fontsize=14`: Устанавливает размер шрифта.
   - `verticalalignment='top'`: Выравнивает текст так, чтобы верхний край текста находился на указанной y - координате.
   - `bbox=properties`: Применяет наши свойства текстового блока.

Текстовый блок останется в той же позиции относительно осей графика, даже если вы увеличите масштаб графика или измените диапазон данных. Это происходит потому, что мы использовали `transform=ax.transAxes`, которая использует координаты осей вместо координат данных.
